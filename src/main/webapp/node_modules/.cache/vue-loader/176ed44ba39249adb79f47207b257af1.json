{"remainingRequest":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/profile/components/UserCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/profile/components/UserCard.vue","mtime":1579772702362},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js","mtime":1578533613779},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1578533683571}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PanThumb from '@/components/PanThumb'\nimport Avatar from './Avatar'\nimport { socialLoginUrl } from '@/settings'\n\nexport default {\n  components: { PanThumb, Avatar },\n  props: {\n    user: {\n      type: Object,\n      default: () => {\n        return {\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      socialLoginUrl: socialLoginUrl,\n      logo: [\n        { img: 'gitee.png', name: 'gitee', bind: false, radius: true },\n        { img: 'github.png', name: 'github', bind: false, radius: true },\n        { img: 'tencent_cloud.png', name: 'tencent_cloud', bind: false, radius: true },\n        { img: 'qq.png', name: 'qq', bind: false, radius: false },\n        { img: 'dingtalk.png', name: 'dingtalk', bind: false, radius: true },\n        { img: 'microsoft.png', name: 'microsoft', bind: false, radius: false }\n      ],\n      oauthType: '',\n      page: {\n        width: window.screen.width * 0.5,\n        height: window.screen.height * 0.5\n      }\n    }\n  },\n  computed: {\n    avatar() {\n      return require(`@/assets/avatar/${this.user.avatar}`)\n    }\n  },\n  mounted() {\n    this.findUserConnections()\n  },\n  destroyed() {\n    window.removeEventListener('message', this.resolveBindResult)\n  },\n  methods: {\n    changeSuccess(avatar) {\n      this.dialogVisible = false;\n      this.$message({\n        message: this.$t('tips.updateSuccess'),\n        type: 'success'\n      });\n      this.user.avatar = avatar;\n      this.$store.commit('account/setUser', this.user)\n    },\n    resolveLogo(logo) {\n      return require(`@/assets/logo/${logo}`)\n    },\n    findUserConnections() {\n      this.$get(`auth/social/connections/${this.user.username}`).then((r) => {\n        const data = r.data;\n        data.forEach(d => {\n          this.logo.forEach(l => {\n            if (l.name === d.providerName.toLowerCase()) {\n              l.bind = true\n            }\n          })\n        })\n      })\n    },\n    bind(name) {\n      this.oauthType = name;\n      const url = `${this.socialLoginUrl}/${name}/bind`;\n      window.open(url, 'newWindow', `height=${this.page.height}, width=${this.page.width}, top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no`);\n      window.addEventListener('message', this.resolveBindResult, false)\n    },\n    resolveBindResult(e) {\n      const data = e.data.data;\n      data.token = null;\n      this.$post('auth/social/bind', {\n        ...data,\n        bindUsername: this.user.username\n      }).then((r) => {\n        this.logo.forEach(l => {\n          if (l.name === this.oauthType) {\n            l.bind = true\n          }\n        });\n        this.$message({\n          message: this.$t('common.bindSuccess'),\n          type: 'success'\n        })\n      })\n    },\n    unbind(name) {\n      this.$confirm(this.$t('common.confirmUnbind'), this.$t('common.tips'), {\n        confirmButtonText: this.$t('common.confirm'),\n        cancelButtonText: this.$t('common.cancel'),\n        type: 'warning'\n      }).then(() => {\n        this.$delete('auth/social/unbind', {\n          bindUsername: this.user.username,\n          oauthType: name\n        }).then(() => {\n          this.logo.forEach(l => {\n            if (l.name === name) {\n              l.bind = false\n            }\n          });\n          this.$message({\n            message: this.$t('common.unbindSuccess'),\n            type: 'success'\n          })\n        })\n      }).catch(() => {})\n    }\n  }\n}\n",{"version":3,"sources":["UserCard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserCard.vue","sourceRoot":"src/views/profile/components","sourcesContent":["<template>\n  <el-card style=\"margin-bottom:20px;\">\n    <div slot=\"header\" class=\"clearfix\">\n      <span>{{ $t('common.aboutMe') }}</span>\n    </div>\n    <div class=\"user-profile\">\n      <div class=\"box-center\">\n        <pan-thumb :image=\"avatar\" :height=\"'100px'\" :width=\"'100px'\" :hoverable=\"false\">\n          <el-link type=\"primary\" class=\"change-avatar\" @click=\"dialogVisible = true\">{{ $t('common.changeAvatar') }}</el-link>\n        </pan-thumb>\n      </div>\n      <div class=\"box-center\">\n        <div class=\"user-name text-center\">{{ user.username }}</div>\n        <div class=\"user-role text-center text-muted\">\n          <span>{{ user.departmentName ? user.departmentName : $t('common.noDepartment') }}</span> Â· <span>{{ user.roleName ? user.roleName : $t('common.noRole') }}</span>\n        </div>\n      </div>\n    </div>\n    <div class=\"user-bio\">\n      <div class=\"user-education user-bio-section\">\n        <div class=\"user-bio-section-header\"><el-icon class=\"el-icon-tickets\" /><span>{{ $t('table.user.desc') }}</span></div>\n        <div class=\"user-bio-section-body\">\n          <div class=\"text-muted\">\n            {{ user.description ? user.description: $t('tips.nothing') }}\n          </div>\n        </div>\n      </div>\n      <div class=\"user-education user-bio-section\">\n        <div class=\"user-bio-section-header\"><el-icon class=\"el-icon-connection\" /><span>{{ $t('table.user.social') }}</span></div>\n        <div class=\"user-bio-section-body\">\n          <div class=\"text-muted\">\n            <template v-for=\"(l, index) in logo\">\n              <div :key=\"index\" class=\"logo-wrapper\">\n                <img v-if=\"l.bind\" :src=\"resolveLogo(l.img)\" :class=\"{ 'radius': l.radius }\" alt=\"\" :title=\"$t('common.unbind')\" @click=\"unbind(l.name)\">\n                <img v-else :src=\"resolveLogo(l.img)\" :class=\"{ 'radius': l.radius }\" alt=\"\" :title=\"$t('common.bind')\" class=\"unbind\" @click=\"bind(l.name)\">\n              </div>\n            </template>\n          </div>\n        </div>\n      </div>\n    </div>\n    <avatar\n      :dialog-visible=\"dialogVisible\"\n      @close=\"dialogVisible = false\"\n      @success=\"changeSuccess\"\n    />\n  </el-card>\n</template>\n\n<script>\nimport PanThumb from '@/components/PanThumb'\nimport Avatar from './Avatar'\nimport { socialLoginUrl } from '@/settings'\n\nexport default {\n  components: { PanThumb, Avatar },\n  props: {\n    user: {\n      type: Object,\n      default: () => {\n        return {\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      socialLoginUrl: socialLoginUrl,\n      logo: [\n        { img: 'gitee.png', name: 'gitee', bind: false, radius: true },\n        { img: 'github.png', name: 'github', bind: false, radius: true },\n        { img: 'tencent_cloud.png', name: 'tencent_cloud', bind: false, radius: true },\n        { img: 'qq.png', name: 'qq', bind: false, radius: false },\n        { img: 'dingtalk.png', name: 'dingtalk', bind: false, radius: true },\n        { img: 'microsoft.png', name: 'microsoft', bind: false, radius: false }\n      ],\n      oauthType: '',\n      page: {\n        width: window.screen.width * 0.5,\n        height: window.screen.height * 0.5\n      }\n    }\n  },\n  computed: {\n    avatar() {\n      return require(`@/assets/avatar/${this.user.avatar}`)\n    }\n  },\n  mounted() {\n    this.findUserConnections()\n  },\n  destroyed() {\n    window.removeEventListener('message', this.resolveBindResult)\n  },\n  methods: {\n    changeSuccess(avatar) {\n      this.dialogVisible = false;\n      this.$message({\n        message: this.$t('tips.updateSuccess'),\n        type: 'success'\n      });\n      this.user.avatar = avatar;\n      this.$store.commit('account/setUser', this.user)\n    },\n    resolveLogo(logo) {\n      return require(`@/assets/logo/${logo}`)\n    },\n    findUserConnections() {\n      this.$get(`auth/social/connections/${this.user.username}`).then((r) => {\n        const data = r.data;\n        data.forEach(d => {\n          this.logo.forEach(l => {\n            if (l.name === d.providerName.toLowerCase()) {\n              l.bind = true\n            }\n          })\n        })\n      })\n    },\n    bind(name) {\n      this.oauthType = name;\n      const url = `${this.socialLoginUrl}/${name}/bind`;\n      window.open(url, 'newWindow', `height=${this.page.height}, width=${this.page.width}, top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no`);\n      window.addEventListener('message', this.resolveBindResult, false)\n    },\n    resolveBindResult(e) {\n      const data = e.data.data;\n      data.token = null;\n      this.$post('auth/social/bind', {\n        ...data,\n        bindUsername: this.user.username\n      }).then((r) => {\n        this.logo.forEach(l => {\n          if (l.name === this.oauthType) {\n            l.bind = true\n          }\n        });\n        this.$message({\n          message: this.$t('common.bindSuccess'),\n          type: 'success'\n        })\n      })\n    },\n    unbind(name) {\n      this.$confirm(this.$t('common.confirmUnbind'), this.$t('common.tips'), {\n        confirmButtonText: this.$t('common.confirm'),\n        cancelButtonText: this.$t('common.cancel'),\n        type: 'warning'\n      }).then(() => {\n        this.$delete('auth/social/unbind', {\n          bindUsername: this.user.username,\n          oauthType: name\n        }).then(() => {\n          this.logo.forEach(l => {\n            if (l.name === name) {\n              l.bind = false\n            }\n          });\n          this.$message({\n            message: this.$t('common.unbindSuccess'),\n            type: 'success'\n          })\n        })\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n .box-center {\n   margin: 0 auto;\n   display: table;\n }\n\n .text-muted {\n   color: #777;\n }\n\n .user-profile {\n   .user-name {\n     font-weight: bold;\n   }\n\n   .box-center {\n     padding-top: 10px;\n   }\n\n   .user-role {\n     padding-top: 10px;\n     font-weight: 400;\n     font-size: 14px;\n   }\n\n   .box-social {\n     padding-top: 30px;\n\n     .el-table {\n       border-top: 1px solid #dfe6ec;\n     }\n   }\n\n   .user-follow {\n     padding-top: 20px;\n   }\n }\n\n .user-bio {\n   margin-top: 20px;\n   color: #606266;\n\n   span {\n     padding-left: 4px;\n   }\n   .logo-wrapper {\n     display: inline-block;\n     margin: 10px 0;\n     img {\n       width: 1.4rem;\n       display: inline-block;\n       margin: 0 .6rem;\n       cursor: pointer;\n       &.unbind {\n         -webkit-filter: grayscale(100%);\n         -moz-filter: grayscale(100%);\n         -o-filter: grayscale(100%);\n         filter: grayscale(100%);\n       }\n       &.radius {\n         border-radius: 50%;\n       }\n     }\n   }\n   .user-bio-section {\n     font-size: 14px;\n     padding: 15px 0;\n\n     .user-bio-section-header {\n       border-bottom: 1px solid #dfe6ec;\n       padding-bottom: 10px;\n       margin-bottom: 10px;\n       font-weight: bold;\n     }\n   }\n }\n</style>\n"]}]}