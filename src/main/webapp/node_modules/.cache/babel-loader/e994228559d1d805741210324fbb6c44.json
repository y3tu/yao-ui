{"remainingRequest":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/profile/components/UserCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/profile/components/UserCard.vue","mtime":1579772702362},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js","mtime":1578533613779},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1578533683571}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport PanThumb from '@/components/PanThumb';\nimport Avatar from \"./Avatar\";\nimport { socialLoginUrl } from '@/settings';\nexport default {\n  components: {\n    PanThumb: PanThumb,\n    Avatar: Avatar\n  },\n  props: {\n    user: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    return {\n      dialogVisible: false,\n      socialLoginUrl: socialLoginUrl,\n      logo: [{\n        img: 'gitee.png',\n        name: 'gitee',\n        bind: false,\n        radius: true\n      }, {\n        img: 'github.png',\n        name: 'github',\n        bind: false,\n        radius: true\n      }, {\n        img: 'tencent_cloud.png',\n        name: 'tencent_cloud',\n        bind: false,\n        radius: true\n      }, {\n        img: 'qq.png',\n        name: 'qq',\n        bind: false,\n        radius: false\n      }, {\n        img: 'dingtalk.png',\n        name: 'dingtalk',\n        bind: false,\n        radius: true\n      }, {\n        img: 'microsoft.png',\n        name: 'microsoft',\n        bind: false,\n        radius: false\n      }],\n      oauthType: '',\n      page: {\n        width: window.screen.width * 0.5,\n        height: window.screen.height * 0.5\n      }\n    };\n  },\n  computed: {\n    avatar: function avatar() {\n      return require(\"@/assets/avatar/\".concat(this.user.avatar));\n    }\n  },\n  mounted: function mounted() {\n    this.findUserConnections();\n  },\n  destroyed: function destroyed() {\n    window.removeEventListener('message', this.resolveBindResult);\n  },\n  methods: {\n    changeSuccess: function changeSuccess(avatar) {\n      this.dialogVisible = false;\n      this.$message({\n        message: this.$t('tips.updateSuccess'),\n        type: 'success'\n      });\n      this.user.avatar = avatar;\n      this.$store.commit('account/setUser', this.user);\n    },\n    resolveLogo: function resolveLogo(logo) {\n      return require(\"@/assets/logo/\".concat(logo));\n    },\n    findUserConnections: function findUserConnections() {\n      var _this = this;\n\n      this.$get(\"auth/social/connections/\".concat(this.user.username)).then(function (r) {\n        var data = r.data;\n        data.forEach(function (d) {\n          _this.logo.forEach(function (l) {\n            if (l.name === d.providerName.toLowerCase()) {\n              l.bind = true;\n            }\n          });\n        });\n      });\n    },\n    bind: function bind(name) {\n      this.oauthType = name;\n      var url = \"\".concat(this.socialLoginUrl, \"/\").concat(name, \"/bind\");\n      window.open(url, 'newWindow', \"height=\".concat(this.page.height, \", width=\").concat(this.page.width, \", top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no\"));\n      window.addEventListener('message', this.resolveBindResult, false);\n    },\n    resolveBindResult: function resolveBindResult(e) {\n      var _this2 = this;\n\n      var data = e.data.data;\n      data.token = null;\n      this.$post('auth/social/bind', _objectSpread({}, data, {\n        bindUsername: this.user.username\n      })).then(function (r) {\n        _this2.logo.forEach(function (l) {\n          if (l.name === _this2.oauthType) {\n            l.bind = true;\n          }\n        });\n\n        _this2.$message({\n          message: _this2.$t('common.bindSuccess'),\n          type: 'success'\n        });\n      });\n    },\n    unbind: function unbind(name) {\n      var _this3 = this;\n\n      this.$confirm(this.$t('common.confirmUnbind'), this.$t('common.tips'), {\n        confirmButtonText: this.$t('common.confirm'),\n        cancelButtonText: this.$t('common.cancel'),\n        type: 'warning'\n      }).then(function () {\n        _this3.$delete('auth/social/unbind', {\n          bindUsername: _this3.user.username,\n          oauthType: name\n        }).then(function () {\n          _this3.logo.forEach(function (l) {\n            if (l.name === name) {\n              l.bind = false;\n            }\n          });\n\n          _this3.$message({\n            message: _this3.$t('common.unbindSuccess'),\n            type: 'success'\n          });\n        });\n      }).catch(function () {});\n    }\n  }\n};",{"version":3,"sources":["UserCard.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-card style=\"margin-bottom:20px;\">\n    <div slot=\"header\" class=\"clearfix\">\n      <span>{{ $t('common.aboutMe') }}</span>\n    </div>\n    <div class=\"user-profile\">\n      <div class=\"box-center\">\n        <pan-thumb :image=\"avatar\" :height=\"'100px'\" :width=\"'100px'\" :hoverable=\"false\">\n          <el-link type=\"primary\" class=\"change-avatar\" @click=\"dialogVisible = true\">{{ $t('common.changeAvatar') }}</el-link>\n        </pan-thumb>\n      </div>\n      <div class=\"box-center\">\n        <div class=\"user-name text-center\">{{ user.username }}</div>\n        <div class=\"user-role text-center text-muted\">\n          <span>{{ user.departmentName ? user.departmentName : $t('common.noDepartment') }}</span> · <span>{{ user.roleName ? user.roleName : $t('common.noRole') }}</span>\n        </div>\n      </div>\n    </div>\n    <div class=\"user-bio\">\n      <div class=\"user-education user-bio-section\">\n        <div class=\"user-bio-section-header\"><el-icon class=\"el-icon-tickets\" /><span>{{ $t('table.user.desc') }}</span></div>\n        <div class=\"user-bio-section-body\">\n          <div class=\"text-muted\">\n            {{ user.description ? user.description: $t('tips.nothing') }}\n          </div>\n        </div>\n      </div>\n      <div class=\"user-education user-bio-section\">\n        <div class=\"user-bio-section-header\"><el-icon class=\"el-icon-connection\" /><span>{{ $t('table.user.social') }}</span></div>\n        <div class=\"user-bio-section-body\">\n          <div class=\"text-muted\">\n            <template v-for=\"(l, index) in logo\">\n              <div :key=\"index\" class=\"logo-wrapper\">\n                <img v-if=\"l.bind\" :src=\"resolveLogo(l.img)\" :class=\"{ 'radius': l.radius }\" alt=\"\" :title=\"$t('common.unbind')\" @click=\"unbind(l.name)\">\n                <img v-else :src=\"resolveLogo(l.img)\" :class=\"{ 'radius': l.radius }\" alt=\"\" :title=\"$t('common.bind')\" class=\"unbind\" @click=\"bind(l.name)\">\n              </div>\n            </template>\n          </div>\n        </div>\n      </div>\n    </div>\n    <avatar\n      :dialog-visible=\"dialogVisible\"\n      @close=\"dialogVisible = false\"\n      @success=\"changeSuccess\"\n    />\n  </el-card>\n</template>\n\n<script>\nimport PanThumb from '@/components/PanThumb'\nimport Avatar from './Avatar'\nimport { socialLoginUrl } from '@/settings'\n\nexport default {\n  components: { PanThumb, Avatar },\n  props: {\n    user: {\n      type: Object,\n      default: () => {\n        return {\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      socialLoginUrl: socialLoginUrl,\n      logo: [\n        { img: 'gitee.png', name: 'gitee', bind: false, radius: true },\n        { img: 'github.png', name: 'github', bind: false, radius: true },\n        { img: 'tencent_cloud.png', name: 'tencent_cloud', bind: false, radius: true },\n        { img: 'qq.png', name: 'qq', bind: false, radius: false },\n        { img: 'dingtalk.png', name: 'dingtalk', bind: false, radius: true },\n        { img: 'microsoft.png', name: 'microsoft', bind: false, radius: false }\n      ],\n      oauthType: '',\n      page: {\n        width: window.screen.width * 0.5,\n        height: window.screen.height * 0.5\n      }\n    }\n  },\n  computed: {\n    avatar() {\n      return require(`@/assets/avatar/${this.user.avatar}`)\n    }\n  },\n  mounted() {\n    this.findUserConnections()\n  },\n  destroyed() {\n    window.removeEventListener('message', this.resolveBindResult)\n  },\n  methods: {\n    changeSuccess(avatar) {\n      this.dialogVisible = false;\n      this.$message({\n        message: this.$t('tips.updateSuccess'),\n        type: 'success'\n      });\n      this.user.avatar = avatar;\n      this.$store.commit('account/setUser', this.user)\n    },\n    resolveLogo(logo) {\n      return require(`@/assets/logo/${logo}`)\n    },\n    findUserConnections() {\n      this.$get(`auth/social/connections/${this.user.username}`).then((r) => {\n        const data = r.data;\n        data.forEach(d => {\n          this.logo.forEach(l => {\n            if (l.name === d.providerName.toLowerCase()) {\n              l.bind = true\n            }\n          })\n        })\n      })\n    },\n    bind(name) {\n      this.oauthType = name;\n      const url = `${this.socialLoginUrl}/${name}/bind`;\n      window.open(url, 'newWindow', `height=${this.page.height}, width=${this.page.width}, top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no`);\n      window.addEventListener('message', this.resolveBindResult, false)\n    },\n    resolveBindResult(e) {\n      const data = e.data.data;\n      data.token = null;\n      this.$post('auth/social/bind', {\n        ...data,\n        bindUsername: this.user.username\n      }).then((r) => {\n        this.logo.forEach(l => {\n          if (l.name === this.oauthType) {\n            l.bind = true\n          }\n        });\n        this.$message({\n          message: this.$t('common.bindSuccess'),\n          type: 'success'\n        })\n      })\n    },\n    unbind(name) {\n      this.$confirm(this.$t('common.confirmUnbind'), this.$t('common.tips'), {\n        confirmButtonText: this.$t('common.confirm'),\n        cancelButtonText: this.$t('common.cancel'),\n        type: 'warning'\n      }).then(() => {\n        this.$delete('auth/social/unbind', {\n          bindUsername: this.user.username,\n          oauthType: name\n        }).then(() => {\n          this.logo.forEach(l => {\n            if (l.name === name) {\n              l.bind = false\n            }\n          });\n          this.$message({\n            message: this.$t('common.unbindSuccess'),\n            type: 'success'\n          })\n        })\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n .box-center {\n   margin: 0 auto;\n   display: table;\n }\n\n .text-muted {\n   color: #777;\n }\n\n .user-profile {\n   .user-name {\n     font-weight: bold;\n   }\n\n   .box-center {\n     padding-top: 10px;\n   }\n\n   .user-role {\n     padding-top: 10px;\n     font-weight: 400;\n     font-size: 14px;\n   }\n\n   .box-social {\n     padding-top: 30px;\n\n     .el-table {\n       border-top: 1px solid #dfe6ec;\n     }\n   }\n\n   .user-follow {\n     padding-top: 20px;\n   }\n }\n\n .user-bio {\n   margin-top: 20px;\n   color: #606266;\n\n   span {\n     padding-left: 4px;\n   }\n   .logo-wrapper {\n     display: inline-block;\n     margin: 10px 0;\n     img {\n       width: 1.4rem;\n       display: inline-block;\n       margin: 0 .6rem;\n       cursor: pointer;\n       &.unbind {\n         -webkit-filter: grayscale(100%);\n         -moz-filter: grayscale(100%);\n         -o-filter: grayscale(100%);\n         filter: grayscale(100%);\n       }\n       &.radius {\n         border-radius: 50%;\n       }\n     }\n   }\n   .user-bio-section {\n     font-size: 14px;\n     padding: 15px 0;\n\n     .user-bio-section-header {\n       border-bottom: 1px solid #dfe6ec;\n       padding-bottom: 10px;\n       margin-bottom: 10px;\n       font-weight: bold;\n     }\n   }\n }\n</style>\n"],"sourceRoot":"src/views/profile/components"}]}