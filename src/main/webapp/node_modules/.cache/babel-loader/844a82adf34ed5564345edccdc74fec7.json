{"remainingRequest":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/views/login/index.vue","mtime":1579138418005},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js","mtime":1578533613779},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1578533683571}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport \"core-js/modules/es6.array.reduce\";\nimport _objectSpread from \"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport LangSelect from '@/components/LangSelect';\nimport { socialLoginUrl } from '@/settings';\nimport { randomNum } from '@/utils';\nimport db from '@/utils/localstorage';\nimport axios from 'axios';\nexport default {\n  name: 'Login',\n  components: {\n    LangSelect: LangSelect\n  },\n  data: function data() {\n    return {\n      codeUrl: \"\".concat(process.env.VUE_APP_BASE_API, \"auth/captcha\"),\n      socialLoginUrl: socialLoginUrl,\n      authUser: null,\n      loading: false,\n      imageCode: '',\n      tabActiveName: 'bindLogin',\n      showDialog: false,\n      redirect: undefined,\n      otherQuery: {},\n      randomId: randomNum(24, 16),\n      page: {\n        width: window.screen.width * 0.5,\n        height: window.screen.height * 0.5\n      },\n      login: {\n        type: 'password'\n      },\n      logo: [{\n        img: 'gitee.png',\n        name: 'gitee',\n        radius: true\n      }, {\n        img: 'github.png',\n        name: 'github',\n        radius: true\n      }, {\n        img: 'tencent_cloud.png',\n        name: 'tencent_cloud',\n        radius: true\n      }, {\n        img: 'qq.png',\n        name: 'qq',\n        radius: false\n      }, {\n        img: 'dingtalk.png',\n        name: 'dingtalk',\n        radius: true\n      }, {\n        img: 'microsoft.png',\n        name: 'microsoft',\n        radius: false\n      }],\n      sms: {\n        btnName: this.$t('login.smsButton'),\n        isDisabled: false,\n        time: 60\n      },\n      loginForm: {\n        username: 'y3tu',\n        password: '1234qwer',\n        mobile: '',\n        mobileCode: '',\n        bindUsername: '',\n        bindPassword: '',\n        signUsername: '',\n        signPassword: ''\n      },\n      rules: {\n        username: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        password: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        mobile: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        mobileCode: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        code: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        bindUsername: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        bindPassword: {\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        },\n        signUsername: [{\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 10,\n          message: this.$t('rules.range4to10'),\n          trigger: 'blur'\n        }],\n        signPassword: [{\n          required: true,\n          message: this.$t('rules.require'),\n          trigger: 'blur'\n        }, {\n          min: 6,\n          max: 20,\n          message: this.$t('rules.range6to20'),\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted: function mounted() {\n    db.clear();\n    this.getCodeImage();\n  },\n  methods: {\n    //用户密码登录\n    handleLogin: function handleLogin() {\n      var _this = this;\n\n      var username_c = false;\n      var password_c = false;\n      var code_c = false;\n      this.$refs.loginForm.validateField('username', function (e) {\n        if (!e) {\n          username_c = true;\n        }\n      });\n      this.$refs.loginForm.validateField('password', function (e) {\n        if (!e) {\n          password_c = true;\n        }\n      });\n      this.$refs.loginForm.validateField('code', function (e) {\n        if (!e) {\n          code_c = true;\n        }\n      });\n\n      if (username_c && password_c && code_c) {\n        this.loading = true;\n        var that = this;\n        this.$login('auth/oauth/token', _objectSpread({}, that.loginForm, {\n          key: this.randomId\n        })).then(function (res) {\n          _this.saveLoginData(res);\n\n          _this.getUserDetailInfo();\n\n          _this.loginSuccessCallback();\n        }).catch(function (error) {\n          console.error(error);\n          that.loading = false;\n          that.getCodeImage();\n        });\n      }\n    },\n    //手机验证码登录\n    handleMobileLogin: function handleMobileLogin() {\n      var _this2 = this;\n\n      var mobile_c = false;\n      var mobileCode_c = false;\n      this.$refs.loginForm.validateField('mobile', function (e) {\n        if (!e) {\n          mobile_c = true;\n        }\n      });\n      this.$refs.loginForm.validateField('mobileCode', function (e) {\n        if (!e) {\n          mobileCode_c = true;\n        }\n      });\n\n      if (mobile_c && mobileCode_c) {\n        this.loading = true;\n        var that = this;\n        this.$login('auth/mobile/token', _objectSpread({}, that.loginForm, {\n          key: this.randomId\n        })).then(function (res) {\n          _this2.saveLoginData(res);\n\n          _this2.getUserDetailInfo();\n\n          _this2.loginSuccessCallback();\n        }).catch(function (error) {\n          console.error(error);\n          that.loading = false;\n          that.getCodeImage();\n        });\n      }\n    },\n    //发送手机验证码\n    sendMobileCode: function sendMobileCode() {\n      var _this3 = this;\n\n      var that = this;\n      that.$refs.loginForm.validateField('mobile', function (error) {\n        if (!error) {\n          that.$get('auth/mobile/' + that.loginForm.mobile).then(function (res) {\n            if (res.status === 'SUCCESS') {\n              _this3.$notify({\n                title: '验证码发送成功',\n                message: '验证码为:' + res.data,\n                type: 'success',\n                duration: 6000\n              });\n\n              doInterval();\n            }\n          });\n        }\n      });\n\n      function doInterval() {\n        that.sms.isDisabled = true;\n        var interval = window.setInterval(function () {\n          that.sms.btnName = '(' + that.sms.time + that.$t('login.smsTimeCount');\n          --that.sms.time;\n\n          if (that.sms.time < 0) {\n            that.sms.btnName = that.$t('login.smsAgainButton');\n            that.sms.time = 60;\n            that.sms.isDisabled = false;\n            window.clearInterval(interval);\n          }\n        }, 1000);\n      }\n    },\n    //获取图形验证码\n    getCodeImage: function getCodeImage() {\n      var _this4 = this;\n\n      axios({\n        method: 'GET',\n        url: \"\".concat(this.codeUrl, \"?key=\").concat(this.randomId),\n        responseType: 'arraybuffer'\n      }).then(function (res) {\n        return 'data:image/png;base64,' + btoa(new Uint8Array(res.data).reduce(function (data, byte) {\n          return data + String.fromCharCode(byte);\n        }, ''));\n      }).then(function (res) {\n        _this4.imageCode = res;\n      }).catch(function (e) {\n        if (e.toString().indexOf('429') !== -1) {\n          _this4.$message({\n            message: _this4.$t('tips.tooManyRequest'),\n            type: 'error'\n          });\n        } else {\n          _this4.$message({\n            message: _this4.$t('tips.getCodeImageFailed'),\n            type: 'error'\n          });\n        }\n      });\n    },\n    //切换tab\n    handleTabClick: function handleTabClick(tab, event) {\n      this.tabActiveName = tab.name;\n    },\n    //第三方登录\n    socialLogin: function socialLogin(oauthType) {\n      var url = \"\".concat(this.socialLoginUrl, \"/\").concat(oauthType, \"/login\");\n      window.open(url, 'newWindow', \"resizable=yes, height=\".concat(this.page.height, \", width=\").concat(this.page.width, \", top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no\"));\n      window.addEventListener('message', this.resolveSocialLogin, false);\n    },\n    resolveSocialLogin: function resolveSocialLogin(e) {\n      var data = e.data;\n      var that = this;\n\n      if (data.message === 'not_bind') {\n        that.login.type = 'bind';\n        var authUser = data.data;\n        that.authUser = authUser;\n        that.$confirm(that.$t('common.current') + authUser.source + that.$t('common.socialAccount') + authUser.nickname + that.$t('common.socialTips'), that.$t('common.tips'), {\n          confirmButtonText: that.$t('common.signLogin'),\n          cancelButtonText: that.$t('common.bindLogin'),\n          type: 'warning'\n        }).then(function () {\n          that.tabActiveName = 'signLogin';\n        }).catch(function () {\n          that.tabActiveName = 'bindLogin';\n        });\n      } else if (data.message === 'social_login_success') {\n        that.saveLoginData(data.data.token);\n        that.getUserDetailInfo();\n        that.loginSuccessCallback();\n      } else {// do nothing\n      }\n    },\n    bindLogin: function bindLogin() {\n      var _this5 = this;\n\n      var username_c = false;\n      var password_c = false;\n      this.$refs.loginForm.validateField('bindUsername', function (e) {\n        if (!e) {\n          username_c = true;\n        }\n      });\n      this.$refs.loginForm.validateField('bindPassword', function (e) {\n        if (!e) {\n          password_c = true;\n        }\n      });\n\n      if (username_c && password_c) {\n        this.loading = true;\n        var that = this;\n\n        var params = _objectSpread({\n          bindUsername: that.loginForm.bindUsername,\n          bindPassword: that.loginForm.bindPassword\n        }, that.authUser);\n\n        params.token = null;\n        that.$post('auth/social/bind/login', params).then(function (r) {\n          var data = r.data;\n\n          _this5.saveLoginData(data);\n\n          _this5.getUserDetailInfo();\n\n          _this5.loginSuccessCallback();\n        }).catch(function (error) {\n          console.error(error);\n          that.loading = false;\n        });\n      }\n    },\n    signLogin: function signLogin() {\n      var _this6 = this;\n\n      var username_c = false;\n      var password_c = false;\n      this.$refs.loginForm.validateField('signUsername', function (e) {\n        if (!e) {\n          username_c = true;\n        }\n      });\n      this.$refs.loginForm.validateField('signPassword', function (e) {\n        if (!e) {\n          password_c = true;\n        }\n      });\n\n      if (username_c && password_c) {\n        this.loading = true;\n        var that = this;\n\n        var params = _objectSpread({\n          bindUsername: that.loginForm.signUsername,\n          bindPassword: that.loginForm.signPassword\n        }, that.authUser);\n\n        params.token = null;\n        that.$post('auth/social/sign/login', params).then(function (r) {\n          var data = r.data;\n\n          _this6.saveLoginData(data);\n\n          _this6.getUserDetailInfo();\n\n          _this6.loginSuccessCallback();\n        }).catch(function (error) {\n          console.error(error);\n          that.loading = false;\n        });\n      }\n    },\n    resolveLogo: function resolveLogo(logo) {\n      return require(\"@/assets/logo/\".concat(logo));\n    },\n    saveLoginData: function saveLoginData(data) {\n      this.$store.commit('account/setAccessToken', data.access_token);\n      this.$store.commit('account/setRefreshToken', data.refresh_token);\n      var current = new Date();\n      var expireTime = current.setTime(current.getTime() + 1000 * data.expires_in);\n      this.$store.commit('account/setExpireTime', expireTime);\n    },\n    getUserDetailInfo: function getUserDetailInfo() {\n      var _this7 = this;\n\n      this.$get('auth/user').then(function (r) {\n        _this7.$store.commit('account/setUser', r.principal);\n\n        _this7.$message({\n          message: _this7.$t('tips.loginSuccess'),\n          type: 'success'\n        });\n\n        _this7.loading = false;\n\n        _this7.$router.push('/');\n      }).catch(function (error) {\n        _this7.$message({\n          message: _this7.$t('tips.loginFail'),\n          type: 'error'\n        });\n\n        console.error(error);\n        _this7.loading = false;\n      });\n    },\n    //登录成功更新登录时间\n    loginSuccessCallback: function loginSuccessCallback() {\n      this.$get('upms/user/success').catch(function (e) {\n        console.log(e);\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiMA,OAAA,UAAA,MAAA,yBAAA;AACA,SAAA,cAAA,QAAA,YAAA;AACA,SAAA,SAAA,QAAA,SAAA;AACA,OAAA,EAAA,MAAA,sBAAA;AACA,OAAA,KAAA,MAAA,OAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,UAAA,EAAA;AAAA,IAAA,UAAA,EAAA;AAAA,GAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,OAAA,YAAA,OAAA,CAAA,GAAA,CAAA,gBAAA,iBADA;AAEA,MAAA,cAAA,EAAA,cAFA;AAGA,MAAA,QAAA,EAAA,IAHA;AAIA,MAAA,OAAA,EAAA,KAJA;AAKA,MAAA,SAAA,EAAA,EALA;AAMA,MAAA,aAAA,EAAA,WANA;AAOA,MAAA,UAAA,EAAA,KAPA;AAQA,MAAA,QAAA,EAAA,SARA;AASA,MAAA,UAAA,EAAA,EATA;AAUA,MAAA,QAAA,EAAA,SAAA,CAAA,EAAA,EAAA,EAAA,CAVA;AAWA,MAAA,IAAA,EAAA;AACA,QAAA,KAAA,EAAA,MAAA,CAAA,MAAA,CAAA,KAAA,GAAA,GADA;AAEA,QAAA,MAAA,EAAA,MAAA,CAAA,MAAA,CAAA,MAAA,GAAA;AAFA,OAXA;AAeA,MAAA,KAAA,EAAA;AACA,QAAA,IAAA,EAAA;AADA,OAfA;AAkBA,MAAA,IAAA,EAAA,CACA;AAAA,QAAA,GAAA,EAAA,WAAA;AAAA,QAAA,IAAA,EAAA,OAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OADA,EAEA;AAAA,QAAA,GAAA,EAAA,YAAA;AAAA,QAAA,IAAA,EAAA,QAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OAFA,EAGA;AAAA,QAAA,GAAA,EAAA,mBAAA;AAAA,QAAA,IAAA,EAAA,eAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OAHA,EAIA;AAAA,QAAA,GAAA,EAAA,QAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OAJA,EAKA;AAAA,QAAA,GAAA,EAAA,cAAA;AAAA,QAAA,IAAA,EAAA,UAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OALA,EAMA;AAAA,QAAA,GAAA,EAAA,eAAA;AAAA,QAAA,IAAA,EAAA,WAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OANA,CAlBA;AA0BA,MAAA,GAAA,EAAA;AACA,QAAA,OAAA,EAAA,KAAA,EAAA,CAAA,iBAAA,CADA;AAEA,QAAA,UAAA,EAAA,KAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OA1BA;AA+BA,MAAA,SAAA,EAAA;AACA,QAAA,QAAA,EAAA,MADA;AAEA,QAAA,QAAA,EAAA,UAFA;AAGA,QAAA,MAAA,EAAA,EAHA;AAIA,QAAA,UAAA,EAAA,EAJA;AAKA,QAAA,YAAA,EAAA,EALA;AAMA,QAAA,YAAA,EAAA,EANA;AAOA,QAAA,YAAA,EAAA,EAPA;AAQA,QAAA,YAAA,EAAA;AARA,OA/BA;AAyCA,MAAA,KAAA,EAAA;AACA,QAAA,QAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA;AAEA,QAAA,QAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAFA;AAGA,QAAA,MAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAHA;AAIA,QAAA,UAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAJA;AAKA,QAAA,IAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SALA;AAMA,QAAA,YAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SANA;AAOA,QAAA,YAAA,EAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAPA;AAQA,QAAA,YAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,EAEA;AAAA,UAAA,GAAA,EAAA,CAAA;AAAA,UAAA,GAAA,EAAA,EAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,kBAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAFA,CARA;AAYA,QAAA,YAAA,EAAA,CACA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,eAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SADA,EAEA;AAAA,UAAA,GAAA,EAAA,CAAA;AAAA,UAAA,GAAA,EAAA,EAAA;AAAA,UAAA,OAAA,EAAA,KAAA,EAAA,CAAA,kBAAA,CAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAFA;AAZA;AAzCA,KAAA;AA2DA,GA/DA;AAgEA,EAAA,OAhEA,qBAgEA;AACA,IAAA,EAAA,CAAA,KAAA;AACA,SAAA,YAAA;AACA,GAnEA;AAoEA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,WAFA,yBAEA;AAAA;;AACA,UAAA,UAAA,GAAA,KAAA;AACA,UAAA,UAAA,GAAA,KAAA;AACA,UAAA,MAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,UAAA,EAAA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,EAAA;AACA,UAAA,UAAA,GAAA,IAAA;AACA;AACA,OAJA;AAKA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,UAAA,EAAA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,EAAA;AACA,UAAA,UAAA,GAAA,IAAA;AACA;AACA,OAJA;AAKA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,MAAA,EAAA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,EAAA;AACA,UAAA,MAAA,GAAA,IAAA;AACA;AACA,OAJA;;AAKA,UAAA,UAAA,IAAA,UAAA,IAAA,MAAA,EAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,YAAA,IAAA,GAAA,IAAA;AACA,aAAA,MAAA,CAAA,kBAAA,oBACA,IAAA,CAAA,SADA;AAEA,UAAA,GAAA,EAAA,KAAA;AAFA,YAGA,IAHA,CAGA,UAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,aAAA,CAAA,GAAA;;AACA,UAAA,KAAA,CAAA,iBAAA;;AACA,UAAA,KAAA,CAAA,oBAAA;AACA,SAPA,EAOA,KAPA,CAOA,UAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,KAAA;AACA,UAAA,IAAA,CAAA,YAAA;AACA,SAXA;AAYA;AACA,KArCA;AAsCA;AACA,IAAA,iBAvCA,+BAuCA;AAAA;;AACA,UAAA,QAAA,GAAA,KAAA;AACA,UAAA,YAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,QAAA,EAAA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,EAAA;AACA,UAAA,QAAA,GAAA,IAAA;AACA;AACA,OAJA;AAKA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,YAAA,EAAA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,EAAA;AACA,UAAA,YAAA,GAAA,IAAA;AACA;AACA,OAJA;;AAKA,UAAA,QAAA,IAAA,YAAA,EAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,YAAA,IAAA,GAAA,IAAA;AACA,aAAA,MAAA,CAAA,mBAAA,oBACA,IAAA,CAAA,SADA;AAEA,UAAA,GAAA,EAAA,KAAA;AAFA,YAGA,IAHA,CAGA,UAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,aAAA,CAAA,GAAA;;AACA,UAAA,MAAA,CAAA,iBAAA;;AACA,UAAA,MAAA,CAAA,oBAAA;AACA,SAPA,EAOA,KAPA,CAOA,UAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,KAAA;AACA,UAAA,IAAA,CAAA,YAAA;AACA,SAXA;AAYA;AACA,KApEA;AAqEA;AACA,IAAA,cAtEA,4BAsEA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA;AACA,MAAA,IAAA,CAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,QAAA,EAAA,UAAA,KAAA,EAAA;AACA,YAAA,CAAA,KAAA,EAAA;AACA,UAAA,IAAA,CAAA,IAAA,CAAA,iBAAA,IAAA,CAAA,SAAA,CAAA,MAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,MAAA,KAAA,SAAA,EAAA;AACA,cAAA,MAAA,CAAA,OAAA,CAAA;AACA,gBAAA,KAAA,EAAA,SADA;AAEA,gBAAA,OAAA,EAAA,UAAA,GAAA,CAAA,IAFA;AAGA,gBAAA,IAAA,EAAA,SAHA;AAIA,gBAAA,QAAA,EAAA;AAJA,eAAA;;AAMA,cAAA,UAAA;AACA;AACA,WAVA;AAWA;AACA,OAdA;;AAgBA,eAAA,UAAA,GAAA;AACA,QAAA,IAAA,CAAA,GAAA,CAAA,UAAA,GAAA,IAAA;AACA,YAAA,QAAA,GAAA,MAAA,CAAA,WAAA,CAAA,YAAA;AACA,UAAA,IAAA,CAAA,GAAA,CAAA,OAAA,GAAA,MAAA,IAAA,CAAA,GAAA,CAAA,IAAA,GAAA,IAAA,CAAA,EAAA,CAAA,oBAAA,CAAA;AACA,YAAA,IAAA,CAAA,GAAA,CAAA,IAAA;;AACA,cAAA,IAAA,CAAA,GAAA,CAAA,IAAA,GAAA,CAAA,EAAA;AACA,YAAA,IAAA,CAAA,GAAA,CAAA,OAAA,GAAA,IAAA,CAAA,EAAA,CAAA,sBAAA,CAAA;AACA,YAAA,IAAA,CAAA,GAAA,CAAA,IAAA,GAAA,EAAA;AACA,YAAA,IAAA,CAAA,GAAA,CAAA,UAAA,GAAA,KAAA;AACA,YAAA,MAAA,CAAA,aAAA,CAAA,QAAA;AACA;AACA,SATA,EASA,IATA,CAAA;AAUA;AACA,KArGA;AAsGA;AACA,IAAA,YAvGA,0BAuGA;AAAA;;AACA,MAAA,KAAA,CAAA;AACA,QAAA,MAAA,EAAA,KADA;AAEA,QAAA,GAAA,YAAA,KAAA,OAAA,kBAAA,KAAA,QAAA,CAFA;AAGA,QAAA,YAAA,EAAA;AAHA,OAAA,CAAA,CAIA,IAJA,CAIA,UAAA,GAAA,EAAA;AACA,eAAA,2BAAA,IAAA,CACA,IAAA,UAAA,CAAA,GAAA,CAAA,IAAA,EACA,MADA,CACA,UAAA,IAAA,EAAA,IAAA;AAAA,iBAAA,IAAA,GAAA,MAAA,CAAA,YAAA,CAAA,IAAA,CAAA;AAAA,SADA,EACA,EADA,CADA,CAAA;AAIA,OATA,EASA,IATA,CASA,UAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,SAAA,GAAA,GAAA;AACA,OAXA,EAWA,KAXA,CAWA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,CAAA,QAAA,GAAA,OAAA,CAAA,KAAA,MAAA,CAAA,CAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA;AACA,YAAA,OAAA,EAAA,MAAA,CAAA,EAAA,CAAA,qBAAA,CADA;AAEA,YAAA,IAAA,EAAA;AAFA,WAAA;AAIA,SALA,MAKA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA;AACA,YAAA,OAAA,EAAA,MAAA,CAAA,EAAA,CAAA,yBAAA,CADA;AAEA,YAAA,IAAA,EAAA;AAFA,WAAA;AAIA;AACA,OAvBA;AAwBA,KAhIA;AAiIA;AACA,IAAA,cAlIA,0BAkIA,GAlIA,EAkIA,KAlIA,EAkIA;AACA,WAAA,aAAA,GAAA,GAAA,CAAA,IAAA;AACA,KApIA;AAqIA;AACA,IAAA,WAtIA,uBAsIA,SAtIA,EAsIA;AACA,UAAA,GAAA,aAAA,KAAA,cAAA,cAAA,SAAA,WAAA;AACA,MAAA,MAAA,CAAA,IAAA,CAAA,GAAA,EAAA,WAAA,kCAAA,KAAA,IAAA,CAAA,MAAA,qBAAA,KAAA,IAAA,CAAA,KAAA;AACA,MAAA,MAAA,CAAA,gBAAA,CAAA,SAAA,EAAA,KAAA,kBAAA,EAAA,KAAA;AACA,KA1IA;AA2IA,IAAA,kBA3IA,8BA2IA,CA3IA,EA2IA;AACA,UAAA,IAAA,GAAA,CAAA,CAAA,IAAA;AACA,UAAA,IAAA,GAAA,IAAA;;AACA,UAAA,IAAA,CAAA,OAAA,KAAA,UAAA,EAAA;AACA,QAAA,IAAA,CAAA,KAAA,CAAA,IAAA,GAAA,MAAA;AACA,YAAA,QAAA,GAAA,IAAA,CAAA,IAAA;AACA,QAAA,IAAA,CAAA,QAAA,GAAA,QAAA;AACA,QAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,CAAA,gBAAA,IAAA,QAAA,CAAA,MAAA,GAAA,IAAA,CAAA,EAAA,CAAA,sBAAA,CAAA,GAAA,QAAA,CAAA,QAAA,GAAA,IAAA,CAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,IAAA,CAAA,EAAA,CAAA,aAAA,CAAA,EAAA;AACA,UAAA,iBAAA,EAAA,IAAA,CAAA,EAAA,CAAA,kBAAA,CADA;AAEA,UAAA,gBAAA,EAAA,IAAA,CAAA,EAAA,CAAA,kBAAA,CAFA;AAGA,UAAA,IAAA,EAAA;AAHA,SAAA,EAIA,IAJA,CAIA,YAAA;AACA,UAAA,IAAA,CAAA,aAAA,GAAA,WAAA;AACA,SANA,EAMA,KANA,CAMA,YAAA;AACA,UAAA,IAAA,CAAA,aAAA,GAAA,WAAA;AACA,SARA;AASA,OAbA,MAaA,IAAA,IAAA,CAAA,OAAA,KAAA,sBAAA,EAAA;AACA,QAAA,IAAA,CAAA,aAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA;AACA,QAAA,IAAA,CAAA,iBAAA;AACA,QAAA,IAAA,CAAA,oBAAA;AACA,OAJA,MAIA,CACA;AACA;AACA,KAlKA;AAmKA,IAAA,SAnKA,uBAmKA;AAAA;;AACA,UAAA,UAAA,GAAA,KAAA;AACA,UAAA,UAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,cAAA,EAAA,UAAA,CAAA,EAAA;AAAA,YAAA,CAAA,CAAA,EAAA;AAAA,UAAA,UAAA,GAAA,IAAA;AAAA;AAAA,OAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,cAAA,EAAA,UAAA,CAAA,EAAA;AAAA,YAAA,CAAA,CAAA,EAAA;AAAA,UAAA,UAAA,GAAA,IAAA;AAAA;AAAA,OAAA;;AACA,UAAA,UAAA,IAAA,UAAA,EAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,YAAA,IAAA,GAAA,IAAA;;AACA,YAAA,MAAA;AACA,UAAA,YAAA,EAAA,IAAA,CAAA,SAAA,CAAA,YADA;AAEA,UAAA,YAAA,EAAA,IAAA,CAAA,SAAA,CAAA;AAFA,WAGA,IAAA,CAAA,QAHA,CAAA;;AAKA,QAAA,MAAA,CAAA,KAAA,GAAA,IAAA;AACA,QAAA,IAAA,CAAA,KAAA,CAAA,wBAAA,EAAA,MAAA,EAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,IAAA,GAAA,CAAA,CAAA,IAAA;;AACA,UAAA,MAAA,CAAA,aAAA,CAAA,IAAA;;AACA,UAAA,MAAA,CAAA,iBAAA;;AACA,UAAA,MAAA,CAAA,oBAAA;AACA,SALA,EAKA,KALA,CAKA,UAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,KAAA;AACA,SARA;AASA;AACA,KA3LA;AA4LA,IAAA,SA5LA,uBA4LA;AAAA;;AACA,UAAA,UAAA,GAAA,KAAA;AACA,UAAA,UAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,cAAA,EAAA,UAAA,CAAA,EAAA;AAAA,YAAA,CAAA,CAAA,EAAA;AAAA,UAAA,UAAA,GAAA,IAAA;AAAA;AAAA,OAAA;AACA,WAAA,KAAA,CAAA,SAAA,CAAA,aAAA,CAAA,cAAA,EAAA,UAAA,CAAA,EAAA;AAAA,YAAA,CAAA,CAAA,EAAA;AAAA,UAAA,UAAA,GAAA,IAAA;AAAA;AAAA,OAAA;;AACA,UAAA,UAAA,IAAA,UAAA,EAAA;AACA,aAAA,OAAA,GAAA,IAAA;AACA,YAAA,IAAA,GAAA,IAAA;;AACA,YAAA,MAAA;AACA,UAAA,YAAA,EAAA,IAAA,CAAA,SAAA,CAAA,YADA;AAEA,UAAA,YAAA,EAAA,IAAA,CAAA,SAAA,CAAA;AAFA,WAGA,IAAA,CAAA,QAHA,CAAA;;AAKA,QAAA,MAAA,CAAA,KAAA,GAAA,IAAA;AACA,QAAA,IAAA,CAAA,KAAA,CAAA,wBAAA,EAAA,MAAA,EAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,IAAA,GAAA,CAAA,CAAA,IAAA;;AACA,UAAA,MAAA,CAAA,aAAA,CAAA,IAAA;;AACA,UAAA,MAAA,CAAA,iBAAA;;AACA,UAAA,MAAA,CAAA,oBAAA;AACA,SALA,EAKA,KALA,CAKA,UAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,KAAA;AACA,SARA;AASA;AACA,KApNA;AAqNA,IAAA,WArNA,uBAqNA,IArNA,EAqNA;AACA,aAAA,OAAA,yBAAA,IAAA,EAAA;AACA,KAvNA;AAwNA,IAAA,aAxNA,yBAwNA,IAxNA,EAwNA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,wBAAA,EAAA,IAAA,CAAA,YAAA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,yBAAA,EAAA,IAAA,CAAA,aAAA;AACA,UAAA,OAAA,GAAA,IAAA,IAAA,EAAA;AACA,UAAA,UAAA,GAAA,OAAA,CAAA,OAAA,CAAA,OAAA,CAAA,OAAA,KAAA,OAAA,IAAA,CAAA,UAAA,CAAA;AACA,WAAA,MAAA,CAAA,MAAA,CAAA,uBAAA,EAAA,UAAA;AACA,KA9NA;AA+NA,IAAA,iBA/NA,+BA+NA;AAAA;;AACA,WAAA,IAAA,CAAA,WAAA,EAAA,IAAA,CAAA,UAAA,CAAA,EAAA;AACA,QAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,iBAAA,EAAA,CAAA,CAAA,SAAA;;AACA,QAAA,MAAA,CAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,MAAA,CAAA,EAAA,CAAA,mBAAA,CADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;;AAIA,QAAA,MAAA,CAAA,OAAA,GAAA,KAAA;;AACA,QAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA,GAAA;AACA,OARA,EAQA,KARA,CAQA,UAAA,KAAA,EAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,MAAA,CAAA,EAAA,CAAA,gBAAA,CADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;;AAIA,QAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,QAAA,MAAA,CAAA,OAAA,GAAA,KAAA;AACA,OAfA;AAgBA,KAhPA;AAiPA;AACA,IAAA,oBAlPA,kCAkPA;AACA,WAAA,IAAA,CAAA,mBAAA,EAAA,KAAA,CAAA,UAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AACA,OAFA;AAGA;AAtPA;AApEA,CAAA","sourcesContent":["<template>\n\n    <div class=\"login-container\">\n        <div class=\"login-info\">\n            <div class=\"title\">Yao</div>\n            <div class=\"sub-title\">{{ $t('common.system') }}</div>\n            <div class=\"desc\">1. {{ $t('common.desc.a') }}</div>\n            <div class=\"desc\">2. {{ $t('common.desc.b') }}</div>\n            <div class=\"desc\">3. {{ $t('common.desc.c') }}</div>\n            <div class=\"desc\">4. {{ $t('common.desc.d') }}</div>\n            <div class=\"desc\">5. {{ $t('common.desc.e') }}</div>\n            <div class=\"desc\">6. {{ $t('common.desc.f') }}</div>\n            <div class=\"desc\">7. {{ $t('common.desc.g') }}</div>\n            <div class=\"desc\">8. {{ $t('common.desc.h') }}</div>\n        </div>\n\n        <el-form ref=\"loginForm\" :model=\"loginForm\" :rules=\"rules\" class=\"login-form\" autocomplete=\"off\" label-position=\"left\">\n            <div class=\"title-container\">\n                <h3 class=\"title\">\n                    {{ $t('login.title') }}\n                </h3>\n                <lang-select class=\"set-language\"/>\n            </div>\n\n            <span v-if=\"login.type === 'password'\">\n                <el-form-item prop=\"username\">\n                      <el-input\n                              ref=\"username\"\n                              v-model=\"loginForm.username\"\n                              :placeholder=\"$t('login.username')\"\n                              prefix-icon=\"el-icon-user\"\n                              name=\"username\"\n                              type=\"text\"\n                              autocomplete=\"off\"\n                              @keyup.enter.native=\"handleLogin\"/>\n                </el-form-item>\n                <el-form-item prop=\"password\">\n                      <el-input\n                              ref=\"password\"\n                              v-model=\"loginForm.password\"\n                              prefix-icon=\"el-icon-key\"\n                              type=\"password\"\n                              :placeholder=\"$t('login.password')\"\n                              name=\"password\"\n                              autocomplete=\"off\"\n                              :show-password=\"true\"\n                              @keyup.enter.native=\"handleLogin\"/>\n                </el-form-item>\n                <el-form-item prop=\"code\" class=\"code-input\">\n                      <el-input\n                              ref=\"code\"\n                              v-model=\"loginForm.code\"\n                              prefix-icon=\"el-icon-lock\"\n                              :placeholder=\"$t('login.code')\"\n                              name=\"code\"\n                              type=\"text\"\n                              autocomplete=\"off\"\n                              style=\"width: 70%\"\n                              @keyup.enter.native=\"handleLogin\"/>\n                </el-form-item>\n                <img :src=\"imageCode\" alt=\"codeImage\" class=\"code-image\" @click=\"getCodeImage\">\n                <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:14px;\" @click.native.prevent=\"handleLogin\">\n                  {{ $t('login.logIn') }}\n                </el-button>\n            </span>\n\n            <span v-if=\"login.type==='mobile'\">\n                <el-form-item prop=\"mobile\">\n                     <el-input\n                             ref=\"mobile\"\n                             v-model=\"loginForm.mobile\"\n                             :placeholder=\"$t('login.mobile')\"\n                             prefix-icon=\"el-icon-mobile-phone\"\n                             name=\"mobile\"\n                             type=\"text\"\n                             autocomplete=\"off\"\n                             @keyup.enter.native=\"handleMobileLogin\"/>\n                </el-form-item>\n                <el-form-item prop=\"mobileCode\">\n                    <el-row :gutter=\"8\">\n                        <el-col :span=\"9\">\n                             <el-input\n                                     ref=\"mobileCode\"\n                                     v-model=\"loginForm.mobileCode\"\n                                     prefix-icon=\"el-icon-lock\"\n                                     :placeholder=\"$t('login.mobileCode')\"\n                                     name=\"mobileCode\"\n                                     type=\"text\"\n                                     autocomplete=\"off\"\n                                     @keyup.enter.native=\"handleMobileLogin\"/>\n                        </el-col>\n                        <el-col :span=\"15\">\n                             <el-button ref=\"smsButton\" @click=\"sendMobileCode\" style=\"width:100%\" :disabled=\"sms.isDisabled\">{{sms.btnName}}</el-button>\n                        </el-col>\n                    </el-row>\n                </el-form-item>\n\n                <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:14px;\" @click.native.prevent=\"handleMobileLogin\">\n                  {{ $t('login.logIn') }}\n                </el-button>\n            </span>\n\n            <span v-if=\"login.type === 'social'\">\n                {{ $t('login.chooseToSignIn') }}\n                <div>\n                  <template v-for=\"(l, index) in logo\">\n                    <div :key=\"index\" class=\"logo-wrapper\">\n                      <img :src=\"resolveLogo(l.img)\" alt=\"\" :class=\"{ 'radius': l.radius }\" @click=\"socialLogin(l.name)\">\n                    </div>\n                  </template>\n                </div>\n            </span>\n\n            <span v-if=\"login.type === 'bind'\" style=\"margin-top: -1rem\">\n                 <el-tabs v-model=\"tabActiveName\" @tab-click=\"handleTabClick\">\n                    <el-tab-pane :label=\"$t('common.bindLogin')\" name=\"bindLogin\">\n                        <el-form-item prop=\"bindUsername\">\n                          <el-input\n                                  ref=\"bindUsername\"\n                                  v-model=\"loginForm.bindUsername\"\n                                  :placeholder=\"$t('login.username')\"\n                                  prefix-icon=\"el-icon-user\"\n                                  name=\"bindUsername\"\n                                  type=\"text\"\n                                  autocomplete=\"off\"/>\n                        </el-form-item>\n                        <el-form-item prop=\"bindPassword\">\n                          <el-input\n                                  ref=\"bindPassword\"\n                                  v-model=\"loginForm.bindPassword\"\n                                  :placeholder=\"$t('login.password')\"\n                                  prefix-icon=\"el-icon-key\"\n                                  name=\"bindPassword\"\n                                  type=\"password\"\n                                  :show-password=\"true\"\n                                  autocomplete=\"off\"/>\n                        </el-form-item>\n                        <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:14px;\" @click.native.prevent=\"bindLogin\">\n                          {{ $t('common.bindLogin') }}\n                        </el-button>\n                    </el-tab-pane>\n                      <el-tab-pane :label=\"$t('common.signLogin')\" name=\"signLogin\">\n                        <el-form-item prop=\"signUsername\">\n                          <el-input\n                                  ref=\"signUsername\"\n                                  v-model=\"loginForm.signUsername\"\n                                  :placeholder=\"$t('login.username')\"\n                                  prefix-icon=\"el-icon-user\"\n                                  name=\"signUsername\"\n                                  type=\"text\"\n                                  autocomplete=\"off\"/>\n                        </el-form-item>\n                        <el-form-item prop=\"signPassword\">\n                          <el-input\n                                  ref=\"signPassword\"\n                                  v-model=\"loginForm.signPassword\"\n                                  :placeholder=\"$t('login.password')\"\n                                  prefix-icon=\"el-icon-key\"\n                                  name=\"signPassword\"\n                                  type=\"password\"\n                                  :show-password=\"true\"\n                                  autocomplete=\"off\"/>\n                        </el-form-item>\n                        <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:14px;\" @click.native.prevent=\"signLogin\">\n                          {{ $t('common.signLogin') }}\n                        </el-button>\n                      </el-tab-pane>\n                 </el-tabs>\n            </span>\n\n            <el-dropdown class=\"login-type\" placement=\"top-end\">\n                <span class=\"el-dropdown-link\">\n                  <el-link type=\"primary\">{{ $t('login.otherLoginType') }}</el-link>\n                </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                    <el-dropdown-item :disabled=\"login.type === 'password'\" @click.native=\"login.type = 'password'\">{{ $t('login.type.password') }}\n                    </el-dropdown-item>\n                    <el-dropdown-item :disabled=\"login.type === 'mobile'\" @click.native=\"login.type = 'mobile'\">{{ $t('login.type.mobile') }}\n                    </el-dropdown-item>\n                    <el-dropdown-item :disabled=\"login.type === 'social'\" @click.native=\"login.type = 'social'\">{{ $t('login.type.social') }}\n                    </el-dropdown-item>\n                </el-dropdown-menu>\n            </el-dropdown>\n\n        </el-form>\n\n        <span class=\"login-footer\">© 2020 <a target=\"_blank\" href=\"http://www.y3tu.com\">Y3tu</a> - Yao</span>\n\n    </div>\n\n</template>\n\n<script>\n    import LangSelect from '@/components/LangSelect'\n    import {socialLoginUrl} from '@/settings'\n    import {randomNum} from '@/utils'\n    import db from '@/utils/localstorage'\n    import axios from 'axios'\n\n    export default {\n        name: 'Login',\n        components: {LangSelect},\n        data() {\n            return {\n                codeUrl: `${process.env.VUE_APP_BASE_API}auth/captcha`,\n                socialLoginUrl: socialLoginUrl,\n                authUser: null,\n                loading: false,\n                imageCode: '',\n                tabActiveName: 'bindLogin',\n                showDialog: false,\n                redirect: undefined,\n                otherQuery: {},\n                randomId: randomNum(24, 16),\n                page: {\n                    width: window.screen.width * 0.5,\n                    height: window.screen.height * 0.5\n                },\n                login: {\n                    type: 'password'\n                },\n                logo: [\n                    {img: 'gitee.png', name: 'gitee', radius: true},\n                    {img: 'github.png', name: 'github', radius: true},\n                    {img: 'tencent_cloud.png', name: 'tencent_cloud', radius: true},\n                    {img: 'qq.png', name: 'qq', radius: false},\n                    {img: 'dingtalk.png', name: 'dingtalk', radius: true},\n                    {img: 'microsoft.png', name: 'microsoft', radius: false}\n                ],\n                sms: {\n                    btnName: this.$t('login.smsButton'),\n                    isDisabled: false,\n                    time: 60\n                },\n                loginForm: {\n                    username: 'y3tu',\n                    password: '1234qwer',\n                    mobile: '',\n                    mobileCode: '',\n                    bindUsername: '',\n                    bindPassword: '',\n                    signUsername: '',\n                    signPassword: ''\n                },\n                rules: {\n                    username: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    password: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    mobile: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    mobileCode: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    code: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    bindUsername: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    bindPassword: {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                    signUsername: [\n                        {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                        {min: 4, max: 10, message: this.$t('rules.range4to10'), trigger: 'blur'}\n                    ],\n                    signPassword: [\n                        {required: true, message: this.$t('rules.require'), trigger: 'blur'},\n                        {min: 6, max: 20, message: this.$t('rules.range6to20'), trigger: 'blur'}\n                    ]\n                }\n            }\n        },\n        mounted() {\n            db.clear();\n            this.getCodeImage();\n        },\n        methods: {\n            //用户密码登录\n            handleLogin() {\n                let username_c = false;\n                let password_c = false;\n                let code_c = false;\n                this.$refs.loginForm.validateField('username', e => {\n                    if (!e) {\n                        username_c = true\n                    }\n                });\n                this.$refs.loginForm.validateField('password', e => {\n                    if (!e) {\n                        password_c = true\n                    }\n                });\n                this.$refs.loginForm.validateField('code', e => {\n                    if (!e) {\n                        code_c = true\n                    }\n                });\n                if (username_c && password_c && code_c) {\n                    this.loading = true;\n                    const that = this;\n                    this.$login('auth/oauth/token', {\n                        ...that.loginForm,\n                        key: this.randomId\n                    }).then((res) => {\n                        this.saveLoginData(res);\n                        this.getUserDetailInfo();\n                        this.loginSuccessCallback()\n                    }).catch((error) => {\n                        console.error(error);\n                        that.loading = false;\n                        that.getCodeImage()\n                    })\n                }\n            },\n            //手机验证码登录\n            handleMobileLogin() {\n                let mobile_c = false;\n                let mobileCode_c = false;\n                this.$refs.loginForm.validateField('mobile', e => {\n                    if (!e) {\n                        mobile_c = true\n                    }\n                });\n                this.$refs.loginForm.validateField('mobileCode', e => {\n                    if (!e) {\n                        mobileCode_c = true\n                    }\n                });\n                if (mobile_c && mobileCode_c) {\n                    this.loading = true;\n                    const that = this;\n                    this.$login('auth/mobile/token', {\n                        ...that.loginForm,\n                        key: this.randomId\n                    }).then((res) => {\n                        this.saveLoginData(res);\n                        this.getUserDetailInfo();\n                        this.loginSuccessCallback()\n                    }).catch((error) => {\n                        console.error(error);\n                        that.loading = false;\n                        that.getCodeImage()\n                    })\n                }\n            },\n            //发送手机验证码\n            sendMobileCode() {\n                let that = this;\n                that.$refs.loginForm.validateField('mobile', (error) => {\n                    if (!error) {\n                        that.$get('auth/mobile/' + that.loginForm.mobile).then((res) => {\n                            if (res.status === 'SUCCESS') {\n                                this.$notify({\n                                    title: '验证码发送成功',\n                                    message: '验证码为:' + res.data,\n                                    type: 'success',\n                                    duration: 6000\n                                });\n                                doInterval()\n                            }\n                        });\n                    }\n                });\n\n                function doInterval() {\n                    that.sms.isDisabled = true;\n                    let interval = window.setInterval(function () {\n                        that.sms.btnName = '(' + that.sms.time + that.$t('login.smsTimeCount');\n                        --that.sms.time;\n                        if (that.sms.time < 0) {\n                            that.sms.btnName = that.$t('login.smsAgainButton');\n                            that.sms.time = 60;\n                            that.sms.isDisabled = false;\n                            window.clearInterval(interval)\n                        }\n                    }, 1000)\n                }\n            },\n            //获取图形验证码\n            getCodeImage() {\n                axios({\n                    method: 'GET',\n                    url: `${this.codeUrl}?key=${this.randomId}`,\n                    responseType: 'arraybuffer'\n                }).then(res => {\n                    return 'data:image/png;base64,' + btoa(\n                        new Uint8Array(res.data)\n                            .reduce((data, byte) => data + String.fromCharCode(byte), '')\n                    )\n                }).then((res) => {\n                    this.imageCode = res\n                }).catch((e) => {\n                    if (e.toString().indexOf('429') !== -1) {\n                        this.$message({\n                            message: this.$t('tips.tooManyRequest'),\n                            type: 'error'\n                        })\n                    } else {\n                        this.$message({\n                            message: this.$t('tips.getCodeImageFailed'),\n                            type: 'error'\n                        })\n                    }\n                })\n            },\n            //切换tab\n            handleTabClick(tab, event) {\n                this.tabActiveName = tab.name\n            },\n            //第三方登录\n            socialLogin(oauthType) {\n                const url = `${this.socialLoginUrl}/${oauthType}/login`;\n                window.open(url, 'newWindow', `resizable=yes, height=${this.page.height}, width=${this.page.width}, top=10%, left=10%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no`);\n                window.addEventListener('message', this.resolveSocialLogin, false)\n            },\n            resolveSocialLogin(e){\n                const data = e.data;\n                const that = this;\n                if (data.message === 'not_bind') {\n                    that.login.type = 'bind';\n                    const authUser = data.data;\n                    that.authUser = authUser;\n                    that.$confirm(that.$t('common.current') + authUser.source + that.$t('common.socialAccount') + authUser.nickname + that.$t('common.socialTips'), that.$t('common.tips'), {\n                        confirmButtonText: that.$t('common.signLogin'),\n                        cancelButtonText: that.$t('common.bindLogin'),\n                        type: 'warning'\n                    }).then(() => {\n                        that.tabActiveName = 'signLogin'\n                    }).catch(() => {\n                        that.tabActiveName = 'bindLogin'\n                    })\n                } else if (data.message === 'social_login_success') {\n                    that.saveLoginData(data.data.token);\n                    that.getUserDetailInfo();\n                    that.loginSuccessCallback()\n                } else {\n                    // do nothing\n                }\n            },\n            bindLogin() {\n                let username_c = false;\n                let password_c = false;\n                this.$refs.loginForm.validateField('bindUsername', e => { if (!e) { username_c = true } });\n                this.$refs.loginForm.validateField('bindPassword', e => { if (!e) { password_c = true } });\n                if (username_c && password_c) {\n                    this.loading = true;\n                    const that = this;\n                    const params = {\n                        bindUsername: that.loginForm.bindUsername,\n                        bindPassword: that.loginForm.bindPassword,\n                        ...that.authUser\n                    };\n                    params.token = null;\n                    that.$post('auth/social/bind/login', params).then((r) => {\n                        const data = r.data;\n                        this.saveLoginData(data);\n                        this.getUserDetailInfo();\n                        this.loginSuccessCallback()\n                    }).catch((error) => {\n                        console.error(error);\n                        that.loading = false\n                    })\n                }\n            },\n            signLogin() {\n                let username_c = false;\n                let password_c = false;\n                this.$refs.loginForm.validateField('signUsername', e => { if (!e) { username_c = true } });\n                this.$refs.loginForm.validateField('signPassword', e => { if (!e) { password_c = true } });\n                if (username_c && password_c) {\n                    this.loading = true;\n                    const that = this;\n                    const params = {\n                        bindUsername: that.loginForm.signUsername,\n                        bindPassword: that.loginForm.signPassword,\n                        ...that.authUser\n                    };\n                    params.token = null;\n                    that.$post('auth/social/sign/login', params).then((r) => {\n                        const data = r.data;\n                        this.saveLoginData(data);\n                        this.getUserDetailInfo();\n                        this.loginSuccessCallback()\n                    }).catch((error) => {\n                        console.error(error);\n                        that.loading = false\n                    })\n                }\n            },\n            resolveLogo(logo) {\n                return require(`@/assets/logo/${logo}`)\n            },\n            saveLoginData(data) {\n                this.$store.commit('account/setAccessToken', data.access_token);\n                this.$store.commit('account/setRefreshToken', data.refresh_token);\n                const current = new Date();\n                const expireTime = current.setTime(current.getTime() + 1000 * data.expires_in);\n                this.$store.commit('account/setExpireTime', expireTime)\n            },\n            getUserDetailInfo() {\n                this.$get('auth/user').then((r) => {\n                    this.$store.commit('account/setUser', r.principal);\n                    this.$message({\n                        message: this.$t('tips.loginSuccess'),\n                        type: 'success'\n                    });\n                    this.loading = false;\n                    this.$router.push('/')\n                }).catch((error) => {\n                    this.$message({\n                        message: this.$t('tips.loginFail'),\n                        type: 'error'\n                    });\n                    console.error(error);\n                    this.loading = false\n                })\n            },\n            //登录成功更新登录时间\n            loginSuccessCallback() {\n                this.$get('upms/user/success').catch((e) => {\n                    console.log(e)\n                })\n            }\n\n        }\n    }\n</script>\n\n<style lang=\"scss\">\n    @import \"login\";\n</style>\n<style lang=\"scss\" scoped>\n    @import \"login-scoped\";\n</style>\n\n"],"sourceRoot":"src/views/login"}]}