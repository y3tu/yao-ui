{"remainingRequest":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/components/HeaderSearch/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/src/components/HeaderSearch/index.vue","mtime":1578551797633},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/babel-loader/lib/index.js","mtime":1578533613779},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/cache-loader/dist/cjs.js","mtime":1578533679077},{"path":"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1578533683571}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport _toConsumableArray from \"/Users/yxy/work/y3tu/yao/yao-ui/src/main/webapp/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// fuse is a lightweight fuzzy-search module\n// make search results more in line with expectations\nimport Fuse from 'fuse.js';\nimport path from 'path';\nimport i18n from '@/lang';\nexport default {\n  name: 'HeaderSearch',\n  data: function data() {\n    return {\n      search: '',\n      options: [],\n      searchPool: [],\n      show: false,\n      fuse: undefined\n    };\n  },\n  computed: {\n    routes: function routes() {\n      return this.$store.state.account.routes;\n    },\n    lang: function lang() {\n      return this.$store.state.setting.language;\n    }\n  },\n  watch: {\n    lang: function lang() {\n      this.searchPool = this.generateRoutes(this.routes);\n    },\n    routes: function routes() {\n      this.searchPool = this.generateRoutes(this.routes);\n    },\n    searchPool: function searchPool(list) {\n      this.initFuse(list);\n    },\n    show: function show(value) {\n      if (value) {\n        document.body.addEventListener('click', this.close);\n      } else {\n        document.body.removeEventListener('click', this.close);\n      }\n    }\n  },\n  mounted: function mounted() {\n    this.searchPool = this.generateRoutes(this.routes);\n  },\n  methods: {\n    click: function click() {\n      this.show = !this.show;\n\n      if (this.show) {\n        this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus();\n      }\n    },\n    close: function close() {\n      this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur();\n      this.options = [];\n      this.show = false;\n    },\n    change: function change(val) {\n      var _this = this;\n\n      this.$router.push(val.path);\n      this.search = '';\n      this.options = [];\n      this.$nextTick(function () {\n        _this.show = false;\n      });\n    },\n    initFuse: function initFuse(list) {\n      this.fuse = new Fuse(list, {\n        shouldSort: true,\n        threshold: 0.4,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: [{\n          name: 'title',\n          weight: 0.7\n        }, {\n          name: 'path',\n          weight: 0.3\n        }]\n      });\n    },\n    // Filter out the routes that can be displayed in the sidebar\n    // And generate the internationalized title\n    generateRoutes: function generateRoutes(routes) {\n      var basePath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n      var prefixTitle = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n      var res = [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = routes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var router = _step.value;\n\n          // skip hidden router\n          if (router.hidden) {\n            continue;\n          }\n\n          var data = {\n            path: path.resolve(basePath, router.path),\n            title: _toConsumableArray(prefixTitle)\n          };\n\n          if (router.meta && router.meta.title) {\n            // generate internationalized title\n            var i18ntitle = i18n.t(\"\".concat(router.meta.title));\n            data.title = [].concat(_toConsumableArray(data.title), [i18ntitle]);\n\n            if (router.redirect !== 'noRedirect') {\n              // only push the routes with title\n              // special case: need to exclude parent router without redirect\n              res.push(data);\n            }\n          } // recursive child routes\n\n\n          if (router.children) {\n            var tempRoutes = this.generateRoutes(router.children, data.path, data.title);\n\n            if (tempRoutes.length >= 1) {\n              res = [].concat(_toConsumableArray(res), _toConsumableArray(tempRoutes));\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return res;\n    },\n    querySearch: function querySearch(query) {\n      if (query !== '') {\n        this.options = this.fuse.search(query);\n      } else {\n        this.options = [];\n      }\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div :class=\"{'show':show}\" class=\"header-search\">\n        <svg-icon class-name=\"search-icon\" icon-class=\"magnifying-glass\" style=\"margin-top: 3px\" @click.stop=\"click\"/>\n        <el-select\n                ref=\"headerSearchSelect\"\n                v-model=\"search\"\n                :remote-method=\"querySearch\"\n                filterable\n                default-first-option\n                remote\n                :placeholder=\"$t('table.search')\"\n                class=\"header-search-select\"\n                @change=\"change\"\n        >\n            <el-option v-for=\"item in options\" :key=\"item.path\" :value=\"item\" :label=\"item.title.join(' > ')\"/>\n        </el-select>\n    </div>\n</template>\n\n<script>\n    // fuse is a lightweight fuzzy-search module\n    // make search results more in line with expectations\n    import Fuse from 'fuse.js'\n    import path from 'path'\n    import i18n from '@/lang'\n\n    export default {\n        name: 'HeaderSearch',\n        data() {\n            return {\n                search: '',\n                options: [],\n                searchPool: [],\n                show: false,\n                fuse: undefined\n            }\n        },\n        computed: {\n            routes() {\n                return this.$store.state.account.routes\n            },\n            lang() {\n                return this.$store.state.setting.language\n            }\n        },\n        watch: {\n            lang() {\n                this.searchPool = this.generateRoutes(this.routes)\n            },\n            routes() {\n                this.searchPool = this.generateRoutes(this.routes)\n            },\n            searchPool(list) {\n                this.initFuse(list)\n            },\n            show(value) {\n                if (value) {\n                    document.body.addEventListener('click', this.close)\n                } else {\n                    document.body.removeEventListener('click', this.close)\n                }\n            }\n        },\n        mounted() {\n            this.searchPool = this.generateRoutes(this.routes)\n        },\n        methods: {\n            click() {\n                this.show = !this.show\n                if (this.show) {\n                    this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus()\n                }\n            },\n            close() {\n                this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur()\n                this.options = []\n                this.show = false\n            },\n            change(val) {\n                this.$router.push(val.path)\n                this.search = ''\n                this.options = []\n                this.$nextTick(() => {\n                    this.show = false\n                })\n            },\n            initFuse(list) {\n                this.fuse = new Fuse(list, {\n                    shouldSort: true,\n                    threshold: 0.4,\n                    location: 0,\n                    distance: 100,\n                    maxPatternLength: 32,\n                    minMatchCharLength: 1,\n                    keys: [{\n                        name: 'title',\n                        weight: 0.7\n                    }, {\n                        name: 'path',\n                        weight: 0.3\n                    }]\n                })\n            },\n            // Filter out the routes that can be displayed in the sidebar\n            // And generate the internationalized title\n            generateRoutes(routes, basePath = '/', prefixTitle = []) {\n                let res = []\n\n                for (const router of routes) {\n                    // skip hidden router\n                    if (router.hidden) {\n                        continue\n                    }\n\n                    const data = {\n                        path: path.resolve(basePath, router.path),\n                        title: [...prefixTitle]\n                    }\n\n                    if (router.meta && router.meta.title) {\n                        // generate internationalized title\n                        const i18ntitle = i18n.t(`${router.meta.title}`)\n\n                        data.title = [...data.title, i18ntitle]\n\n                        if (router.redirect !== 'noRedirect') {\n                            // only push the routes with title\n                            // special case: need to exclude parent router without redirect\n                            res.push(data)\n                        }\n                    }\n\n                    // recursive child routes\n                    if (router.children) {\n                        const tempRoutes = this.generateRoutes(router.children, data.path, data.title)\n                        if (tempRoutes.length >= 1) {\n                            res = [...res, ...tempRoutes]\n                        }\n                    }\n                }\n                return res\n            },\n            querySearch(query) {\n                if (query !== '') {\n                    this.options = this.fuse.search(query)\n                } else {\n                    this.options = []\n                }\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .header-search {\n        font-size: 0 !important;\n\n        .search-icon {\n            cursor: pointer;\n            font-size: 18px;\n            vertical-align: middle;\n        }\n\n        .header-search-select {\n            font-size: 18px;\n            transition: width 0.2s;\n            width: 0;\n            overflow: hidden;\n            background: transparent;\n            border-radius: 0;\n            display: inline-block;\n            vertical-align: middle;\n\n            /deep/ .el-input__inner {\n                border-radius: 0;\n                border: 0;\n                padding-left: 0;\n                padding-right: 0;\n                box-shadow: none !important;\n                border-bottom: 1px solid #d9d9d9;\n                vertical-align: middle;\n            }\n        }\n\n        &.show {\n            .header-search-select {\n                width: 210px;\n                margin-left: 10px;\n            }\n        }\n    }\n</style>\n"],"sourceRoot":"src/components/HeaderSearch"}]}