(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-313a7a36"],{"05cc":function(e,t,n){"use strict";var r=n("d6a9"),i=n.n(r);i.a},"0d6d":function(e,t,n){var r=n("d3f4"),i=n("67ab").onFreeze;n("5eda")("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},"4f59":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:e.crud.toQuery}},[e._v("搜索")]),e._v(" "),e.crud.optShow.reset?n("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.crud.resetQuery()}}},[e._v("重置")]):e._e()],1)},i=[],a=n("c6db"),o={mixins:[Object(a["a"])()],props:{itemClass:{type:String,required:!1,default:""}}},s=o,u=n("0c7c"),d=Object(u["a"])(s,r,i,!1,null,null,null);t["a"]=d.exports},"55b8":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-pagination",{staticStyle:{"margin-top":"8px"},attrs:{"page-size":e.page.size,total:e.page.total,"current-page":e.page.page,layout:"total, prev, pager, next, sizes"},on:{"update:pageSize":function(t){return e.$set(e.page,"size",t)},"update:page-size":function(t){return e.$set(e.page,"size",t)},"update:currentPage":function(t){return e.$set(e.page,"page",t)},"update:current-page":function(t){return e.$set(e.page,"page",t)},"size-change":function(t){return e.crud.sizeChangeHandler(t)},"current-change":e.crud.pageChangeHandler}})},i=[],a=n("c6db"),o={mixins:[Object(a["e"])()]},s=o,u=n("0c7c"),d=Object(u["a"])(s,r,i,!1,null,null,null);t["a"]=d.exports},"55dd":function(e,t,n){"use strict";var r=n("5ca1"),i=n("d8e8"),a=n("4bf8"),o=n("79e5"),s=[].sort,u=[1,2,3];r(r.P+r.F*(o(function(){u.sort(void 0)})||!o(function(){u.sort(null)})||!n("2f21")(s)),"Array",{sort:function(e){return void 0===e?s.call(a(this)):s.call(a(this),i(e))}})},7514:function(e,t,n){"use strict";var r=n("5ca1"),i=n("0a49")(5),a="find",o=!0;a in[]&&Array(1)[a](function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(a)},ab00:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"crud-opts"},[n("span",{staticClass:"crud-opts-left"},[e._t("left"),e._v(" "),e.crud.optShow.add?n("el-button",{directives:[{name:"has-permission",rawName:"v-has-permission",value:e.permission.add,expression:"permission.add"}],staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.crud.toAdd}},[e._v("\n    新增\n  ")]):e._e(),e._v(" "),e.crud.optShow.edit?n("el-button",{directives:[{name:"has-permission",rawName:"v-has-permission",value:e.permission.edit,expression:"permission.edit"}],staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-edit",disabled:1!==e.crud.selections.length},on:{click:function(t){return e.crud.toEdit(e.crud.selections[0])}}},[e._v("\n    修改\n  ")]):e._e(),e._v(" "),e.crud.optShow.del?n("el-button",{directives:[{name:"has-permission",rawName:"v-has-permission",value:e.permission.del,expression:"permission.del"}],staticClass:"filter-item",attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini",loading:e.crud.delAllLoading,disabled:0===e.crud.selections.length},on:{click:function(t){return e.toDelete(e.crud.selections)}},slot:"reference"},[e._v("\n    删除\n  ")]):e._e(),e._v(" "),e.crud.optShow.download?n("el-button",{staticClass:"filter-item",attrs:{loading:e.crud.downloadLoading,disabled:!e.crud.data.length,size:"mini",type:"warning",icon:"el-icon-download"},on:{click:e.crud.doExport}},[e._v("导出")]):e._e(),e._v(" "),e._t("right")],2),e._v(" "),n("el-button-group",{staticClass:"crud-opts-right"},[n("el-button",{attrs:{size:"mini",plain:"",type:"info",icon:"el-icon-search"},on:{click:function(t){return e.toggleSearch()}}}),e._v(" "),n("el-button",{attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:function(t){return e.crud.refresh()}}}),e._v(" "),n("el-popover",{attrs:{placement:"bottom-end",width:"150",trigger:"click"}},[n("el-button",{attrs:{slot:"reference",size:"mini",icon:"el-icon-s-grid"},slot:"reference"},[n("i",{staticClass:"fa fa-caret-down",attrs:{"aria-hidden":"true"}})]),e._v(" "),n("el-checkbox",{attrs:{indeterminate:e.allColumnsSelectedIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.allColumnsSelected,callback:function(t){e.allColumnsSelected=t},expression:"allColumnsSelected"}},[e._v("\n                全选\n            ")]),e._v(" "),e._l(e.tableColumns,function(t){return n("el-checkbox",{key:t.property,on:{change:function(n){return e.handleCheckedTableColumnsChange(t)}},model:{value:t.visible,callback:function(n){e.$set(t,"visible",n)},expression:"item.visible"}},[e._v("\n                "+e._s(t.label)+"\n            ")])})],2)],1)],1)},i=[],a=(n("7514"),n("6d67"),n("d25f"),n("57e7"),n("ac6a"),n("f3e2"),n("c6db"));function o(e,t){var n=Object.assign([],t),r=-1;return e.forEach(function(e){var t=n.indexOf(e);-1===t?(r+=1,n.splice(r,0,e)):r=t}),n}var s={mixins:[Object(a["a"])()],props:{permission:{type:Object,default:function(){return{}}},hiddenColumns:{type:Array,default:function(){return[]}},ignoreColumns:{type:Array,default:function(){return[]}}},data:function(){return{tableColumns:[],allColumnsSelected:!0,allColumnsSelectedIndeterminate:!1,tableUnwatcher:null,ignoreNextTableColumnsChange:!1}},watch:{"crud.props.table":function(){var e=this;this.updateTableColumns(),this.tableColumns.forEach(function(t){-1!==e.hiddenColumns.indexOf(t.property)&&(t.visible=!1,e.updateColumnVisible(t))})},"crud.props.table.store.states.columns":function(){this.updateTableColumns()}},created:function(){this.crud.updateProp("searchToggle",!0)},methods:{updateTableColumns:function(){var e=this,t=this.crud.getTable();if(t){var n=null,r=function(t){return t&&"default"===t.type&&t.property&&-1===e.ignoreColumns.indexOf(t.property)},i=t.columns.filter(r);if(this.ignoreNextTableColumnsChange)this.ignoreNextTableColumnsChange=!1;else{this.ignoreNextTableColumnsChange=!1;var a=[],s=t.$children.map(function(e){return e.columnConfig}).filter(r);n=o(s,i),n.forEach(function(e){var t={property:e.property,label:e.label,visible:-1!==i.indexOf(e)};a.push(t)}),this.tableColumns=a}}else this.tableColumns=[]},toDelete:function(e){var t=this;this.$confirm("确认删除选中的".concat(e.length,"条数据?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.crud.delAllLoading=!0,t.crud.doDelete(e)}).catch(function(){})},handleCheckAllChange:function(e){var t=this;!1!==e?(this.tableColumns.forEach(function(e){e.visible||(e.visible=!0,t.updateColumnVisible(e))}),this.allColumnsSelected=e,this.allColumnsSelectedIndeterminate=!1):this.allColumnsSelected=!0},handleCheckedTableColumnsChange:function(e){var t=0,n=0;if(this.tableColumns.forEach(function(e){++t,n+=e.visible?1:0}),0===n)return this.crud.notify("请至少选择一列",a["b"].NOTIFICATION_TYPE.WARNING),void this.$nextTick(function(){e.visible=!0});this.allColumnsSelected=n===t,this.allColumnsSelectedIndeterminate=n!==t&&0!==n,this.updateColumnVisible(e)},updateColumnVisible:function(e){var t=this.crud.props.table,n=t.$children.find(function(t){return t.prop===e.property}),r=n.columnConfig;if(e.visible){var i=this.tableColumns.indexOf(e);n.owner.store.commit("insertColumn",r,i+1,null)}else n.owner.store.commit("removeColumn",r,null);this.ignoreNextTableColumnsChange=!0},toggleSearch:function(){this.crud.props.searchToggle=!this.crud.props.searchToggle}}},u=s,d=(n("05cc"),n("0c7c")),c=Object(d["a"])(u,r,i,!1,null,null,null);t["a"]=c.exports},c6db:function(e,t,n){"use strict";n.d(t,"f",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"c",function(){return g}),n.d(t,"e",function(){return h}),n.d(t,"a",function(){return p});n("5df3"),n("4f7f"),n("0d6d"),n("20d6"),n("7514");var r=n("7618"),i=(n("55dd"),n("456d"),n("ac6a"),n("f3e2"),n("cebc")),a=n("ed08"),o=n("2b0e");function s(e){var t={tag:"default",idField:"id",title:"",url:"",data:[],selections:[],entity:{},params:{},form:{},defaultForm:function(){},sort:["id,desc"],time:50,crudMethod:{add:function(e){},del:function(e){},edit:function(e){},get:function(e){},download:function(e,t){}},optShow:{add:!0,edit:!0,del:!0,download:!0,reset:!0},props:{},queryOnPresenterCreated:!0,debug:!1};e=d(t,e);var n=Object(i["a"])({},e,{dataStatus:{},status:{add:s.STATUS.NORMAL,edit:s.STATUS.NORMAL,get cu(){if(this.add===s.STATUS.NORMAL&&this.edit===s.STATUS.NORMAL)return s.STATUS.NORMAL;if(this.add===s.STATUS.PREPARED||this.edit===s.STATUS.PREPARED)return s.STATUS.PREPARED;if(this.add===s.STATUS.PROCESSING||this.edit===s.STATUS.PROCESSING)return s.STATUS.PROCESSING;throw new Error("wrong crud's cu status")},get title(){return this.add>s.STATUS.NORMAL?"新增".concat(c.title):this.edit>s.STATUS.NORMAL?"编辑".concat(c.title):c.title}},msg:{submit:"提交成功",add:"新增成功",edit:"编辑成功",del:"删除成功"},page:{page:1,size:10,total:0},loading:!0,downloadLoading:!1,delAllLoading:!1}),a={submitSuccessNotify:function(){c.notify(c.msg.submit,s.NOTIFICATION_TYPE.SUCCESS)},addSuccessNotify:function(){c.notify(c.msg.add,s.NOTIFICATION_TYPE.SUCCESS)},editSuccessNotify:function(){c.notify(c.msg.edit,s.NOTIFICATION_TYPE.SUCCESS)},delSuccessNotify:function(){c.notify(c.msg.del,s.NOTIFICATION_TYPE.SUCCESS)},toQuery:function(){c.page.page=1,c.refresh()},refresh:function(){if(u(c,s.HOOK.beforeRefresh))return new Promise(function(e,t){c.loading=!0,c.vms[0].vm.$page(c.url,c.getQueryParams()).then(function(t){var n=c.getTable();n&&n.lazy&&(n.store.states.treeData={},n.store.states.lazyTreeNodeMap={});var r=t.data;c.page.total=r.total,c.data=r.records,c.resetDataStatus(),setTimeout(function(){c.loading=!1,u(c,s.HOOK.afterRefresh)},c.time),e(r)}).catch(function(e){c.loading=!1,t(e)})})},toAdd:function(){u(c,s.HOOK.beforeToAdd,c.form)&&u(c,s.HOOK.beforeToCU,c.form)&&(c.status.add=s.STATUS.PREPARED,u(c,s.HOOK.afterToAdd,c.form),u(c,s.HOOK.afterToCU,c.form))},toEdit:function(e){c.resetForm(JSON.parse(JSON.stringify(e))),u(c,s.HOOK.beforeToEdit,c.form)&&u(c,s.HOOK.beforeToCU,c.form)&&(c.status.edit=s.STATUS.PREPARED,c.getDataStatus(c.getDataId(e)).edit=s.STATUS.PREPARED,u(c,s.HOOK.afterToEdit,c.form),u(c,s.HOOK.afterToCU,c.form))},toDelete:function(e){c.getDataStatus(c.getDataId(e)).delete=s.STATUS.PREPARED},cancelDelete:function(e){u(c,s.HOOK.beforeDeleteCancel,e)&&(c.getDataStatus(c.getDataId(e)).delete=s.STATUS.NORMAL,u(c,s.HOOK.afterDeleteCancel,e))},cancelCU:function(){var e=c.status.add,t=c.status.edit;if(e===s.STATUS.PREPARED){if(!u(c,s.HOOK.beforeAddCancel,c.form))return;c.status.add=s.STATUS.NORMAL}if(t===s.STATUS.PREPARED){if(!u(c,s.HOOK.beforeEditCancel,c.form))return;c.status.edit=s.STATUS.NORMAL,c.getDataStatus(c.getDataId(c.form)).edit=s.STATUS.NORMAL}c.resetForm(),e===s.STATUS.PREPARED&&u(c,s.HOOK.afterAddCancel,c.form),t===s.STATUS.PREPARED&&u(c,s.HOOK.afterEditCancel,c.form),c.findVM("form").$refs["form"]&&c.findVM("form").$refs["form"].clearValidate()},submitCU:function(){u(c,s.HOOK.beforeValidateCU)&&c.findVM("form").$refs["form"].validate(function(e){e&&u(c,s.HOOK.afterValidateCU)&&(c.status.add===s.STATUS.PREPARED?c.doAdd():c.status.edit===s.STATUS.PREPARED&&c.doEdit())})},doAdd:function(){u(c,s.HOOK.beforeSubmit)&&(c.status.add=s.STATUS.PROCESSING,c.crudMethod.add(c.form).then(function(){c.status.add=s.STATUS.NORMAL,c.resetForm(),c.addSuccessNotify(),u(c,s.HOOK.afterSubmit),c.toQuery()}).catch(function(){c.status.add=s.STATUS.PREPARED,u(c,s.HOOK.afterAddError)}))},doEdit:function(){u(c,s.HOOK.beforeSubmit)&&(c.status.edit=s.STATUS.PROCESSING,c.crudMethod.edit(c.form).then(function(){c.status.edit=s.STATUS.NORMAL,c.getDataStatus(c.getDataId(c.form)).edit=s.STATUS.NORMAL,c.editSuccessNotify(),c.resetForm(),u(c,s.HOOK.afterSubmit),c.refresh()}).catch(function(){c.status.edit=s.STATUS.PREPARED,u(c,s.HOOK.afterEditError)}))},doDelete:function(e){var t,n=!1,r=[];if(e instanceof Array?(n=!0,e.forEach(function(e){r.push(c.getDataId(e))})):(r.push(c.getDataId(e)),t=c.getDataStatus(c.getDataId(e))),u(c,s.HOOK.beforeDelete,e))return n||(t.delete=s.STATUS.PROCESSING),c.crudMethod.del(r).then(function(){n?c.delAllLoading=!1:t.delete=s.STATUS.PREPARED,c.dleChangePage(1),c.delSuccessNotify(),u(c,s.HOOK.afterDelete,e),c.refresh()}).catch(function(){n?c.delAllLoading=!1:t.delete=s.STATUS.PREPARED})},doExport:function(){c.downloadLoading=!0,c.crudMethod.download(c.getQueryParams(),c.title+"数据.xlsx").then(function(e){c.downloadLoading=!1}).catch(function(){c.downloadLoading=!1})},getQueryParams:function(){return 0!==Object.keys(c.entity).length&&Object.keys(c.entity).forEach(function(e){null!==c.entity[e]&&""!==c.entity[e]||(c.entity[e]=void 0)}),0!==Object.keys(c.params).length&&Object.keys(c.params).forEach(function(e){null!==c.params[e]&&""!==c.params[e]||(c.params[e]=void 0)}),{current:c.page.page,size:c.page.size,sort:c.sort,entity:c.entity,params:c.params}},pageChangeHandler:function(e){c.page.page=e,c.refresh()},sizeChangeHandler:function(e){c.page.size=e,c.page.page=1,c.refresh()},dleChangePage:function(e){c.data.length===e&&1!==c.page.page&&(c.page.page-=1)},selectionChangeHandler:function(e){c.selections=e},resetQuery:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=JSON.parse(JSON.stringify(c.defaultEntity)),n=JSON.parse(JSON.stringify(c.defaultParams)),r=c.entity,i=c.params;Object.keys(r).forEach(function(e){r[e]=t[e]}),Object.keys(i).forEach(function(e){i[e]=n[e]}),e&&c.toQuery()},resetForm:function(e){var t=e||("object"===Object(r["a"])(c.defaultForm)?JSON.parse(JSON.stringify(c.defaultForm)):c.defaultForm()),n=c.form;for(var i in t)n.hasOwnProperty(i)?n[i]=t[i]:o["default"].set(n,i,t[i])},resetDataStatus:function(){var e={};function t(n){n.forEach(function(n){e[c.getDataId(n)]={delete:0,edit:0},n.children&&t(n.children)})}t(c.data),c.dataStatus=e},getDataStatus:function(e){return c.dataStatus[e]},selectChange:function(e,t){e.find(function(e){return c.getDataId(e)===c.getDataId(t)})?t.children&&t.children.forEach(function(t){c.getTable().toggleRowSelection(t,!0),e.push(t),t.children&&c.selectChange(e,t)}):c.toggleRowSelection(e,t)},toggleRowSelection:function(e,t){t.children&&t.children.forEach(function(t){c.getTable().toggleRowSelection(t,!1),t.children&&c.toggleRowSelection(e,t)})},findVM:function(e){return c.vms.find(function(t){return t&&t.type===e}).vm},notify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.NOTIFICATION_TYPE.INFO;c.vms[0].vm.$notify({title:e,type:t,duration:2500})},updateProp:function(e,t){o["default"].set(c.props,e,t)},getDataId:function(e){return e[this.idField]},getTable:function(){return this.findVM("presenter").$refs.table},attchTable:function(){var e=this.getTable();this.updateProp("table",e);var t=this;e.$on("expand-change",function(n,r){if(r){var i=e.store.states.lazyTreeNodeMap,a=i[n.id];n.children=a,void 0!=a&&a.forEach(function(e){var n=c.getDataId(e);void 0===t.dataStatus[n]&&(t.dataStatus[n]={delete:0,edit:0})})}})}},c=Object.assign({},n);return o["default"].observable(c),Object.assign(c,a),Object.assign(c,{defaultEntity:JSON.parse(JSON.stringify(n.entity)),defaultParams:JSON.parse(JSON.stringify(n.params)),vms:Array(4),registerVM:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r={type:e,vm:t};n<0?this.vms.push(r):(this.vms.length=Math.max(this.vms.length,n),this.vms.splice(n,1,r))},unregisterVM:function(e){this.vms.splice(this.vms.findIndex(function(t){return t&&t.vm===e}),1)}}),Object.freeze(c),c}function u(e,t){e.debug&&console.log("callVmHook: "+t);for(var n=!0,r=[e],i=2;i<arguments.length;++i)r.push(arguments[i]);var a=new Set;return e.vms.forEach(function(e){return e&&a.add(e.vm)}),a.forEach(function(e){e[t]&&(n=!1!==e[t].apply(e,r)&&n)}),n}function d(e,t){var n=Object(i["a"])({},e);for(var r in e)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function c(e,t){if(t=t||e.$attrs["crud-tag"]||"default",e.$crud){var n=e.$crud[t];if(n)return n}return e.$parent?c(e.$parent,t):void 0}function l(e){return e&&console.warn("[CRUD warn]: please use $options.cruds() { return CRUD(...) or [CRUD(...), ...] }"),{data:function(){return{crud:this.crud}},beforeCreate:function(){var t=this;this.$crud=this.$crud||{};var n=this.$options.cruds instanceof Function?this.$options.cruds():e;n instanceof Array||(n=[n]),n.forEach(function(e){t.$crud[e.tag]&&console.error("[CRUD error]: crud with tag ["+e.tag+" is already exist"),t.$crud[e.tag]=e,e.registerVM("presenter",t,0)}),this.crud=this.$crud["defalut"]||n[0]},methods:{parseTime:function(e,t){return a["b"].date.parseTime(e,t)}},created:function(){for(var e in this.$crud)this.$crud[e].queryOnPresenterCreated&&this.$crud[e].toQuery()},destroyed:function(){for(var e in this.$crud)this.$crud[e].unregisterVM("presenter",this)},mounted:function(){void 0!==this.$refs.table&&this.crud.attchTable()}}}function f(){return{data:function(){return{crud:this.crud,query:this.crud.query}},beforeCreate:function(){this.crud=c(this),this.crud.registerVM("header",this,1)},destroyed:function(){this.crud.unregisterVM("header",this)}}}function h(){return{data:function(){return{crud:this.crud,page:this.crud.page}},beforeCreate:function(){this.crud=c(this),this.crud.registerVM("pagination",this,2)},destroyed:function(){this.crud.unregisterVM("pagination",this)}}}function g(e){return{data:function(){return{crud:this.crud,form:this.crud.form}},beforeCreate:function(){this.crud=c(this),this.crud.registerVM("form",this,3)},created:function(){this.crud.defaultForm=e,this.crud.resetForm()},destroyed:function(){this.crud.unregisterVM("form",this)}}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={type:void 0};return e=d(t,e),{data:function(){return{crud:this.crud}},beforeCreate:function(){this.crud=c(this),this.crud.registerVM(e.type,this)},destroyed:function(){this.crud.unregisterVM(e.type,this)}}}s.HOOK={beforeRefresh:"beforeCrudRefresh",afterRefresh:"afterCrudRefresh",beforeDelete:"beforeCrudDelete",afterDelete:"afterCrudDelete",beforeDeleteCancel:"beforeCrudDeleteCancel",afterDeleteCancel:"afterCrudDeleteCancel",beforeToAdd:"beforeCrudToAdd",afterToAdd:"afterCrudToAdd",beforeToEdit:"beforeCrudToEdit",afterToEdit:"afterCrudToEdit",beforeToCU:"beforeCrudToCU",afterToCU:"afterCrudToCU",beforeValidateCU:"beforeCrudValidateCU",afterValidateCU:"afterCrudValidateCU",beforeAddCancel:"beforeCrudAddCancel",afterAddCancel:"afterCrudAddCancel",beforeEditCancel:"beforeCrudEditCancel",afterEditCancel:"afterCrudEditCancel",beforeSubmit:"beforeCrudSubmitCU",afterSubmit:"afterCrudSubmitCU",afterAddError:"afterCrudAddError",afterEditError:"afterCrudEditError"},s.STATUS={NORMAL:0,PREPARED:1,PROCESSING:2},s.NOTIFICATION_TYPE={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},t["b"]=s},d6a9:function(e,t,n){}}]);