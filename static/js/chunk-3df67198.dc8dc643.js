(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3df67198","chunk-872f0e38","chunk-dc1053fe","chunk-7d97211e"],{5024:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialog,"close-on-click-modal":!1,title:"七牛云配置","append-to-body":"",width:"580px"},on:{"update:visible":function(t){e.dialog=t}}},[a("el-form",{ref:"form",staticStyle:{"margin-top":"6px"},attrs:{model:e.form,rules:e.rules,size:"small","label-width":"110px"}},[a("el-form-item",{attrs:{label:"Access Key",prop:"accessKey"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{placeholder:"accessKey，在安全中心，秘钥管理中查看"},model:{value:e.form.accessKey,callback:function(t){e.$set(e.form,"accessKey",t)},expression:"form.accessKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Secret Key",prop:"secretKey"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{type:"password",placeholder:"secretKey，在安全中心，秘钥管理中查看"},model:{value:e.form.secretKey,callback:function(t){e.$set(e.form,"secretKey",t)},expression:"form.secretKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"空间名称",prop:"bucket"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{placeholder:"存储空间名称作为唯一的 Bucket 识别符"},model:{value:e.form.bucket,callback:function(t){e.$set(e.form,"bucket",t)},expression:"form.bucket"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"外链域名",prop:"host"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{placeholder:"外链域名，可自定义，需在七牛云绑定"},model:{value:e.form.host,callback:function(t){e.$set(e.form,"host",t)},expression:"form.host"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"存储区域"}},[a("el-select",{attrs:{placeholder:"请选择存储区域"},model:{value:e.form.zone,callback:function(t){e.$set(e.form,"zone",t)},expression:"form.zone"}},e._l(e.zones,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"空间类型",prop:"type"}},[a("el-radio",{attrs:{label:"公开"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("公开")]),e._v(" "),a("el-radio",{attrs:{label:"私有"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("私有")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.doSubmit}},[e._v("确认")])],1)],1)},i=[],r=a("a4ba"),o={data:function(){return{zones:["华东","华北","华南","北美","东南亚"],dialog:!1,loading:!1,form:{accessKey:"",secretKey:"",bucket:"",host:"",zone:"",type:""},rules:{accessKey:[{required:!0,message:"请输入accessKey",trigger:"blur"}],secretKey:[{required:!0,message:"请输入secretKey",trigger:"blur"}],bucket:[{required:!0,message:"请输入空间名称",trigger:"blur"}],host:[{required:!0,message:"请输入外链域名",trigger:"blur"}],type:[{required:!0,message:"空间类型不能为空",trigger:"blur"}]}}},methods:{init:function(){var e=this;Object(r["b"])().then(function(t){e.form=t.data})},doSubmit:function(){var e=this;this.$refs["form"].validate(function(t){if(!t)return!1;e.loading=!0,Object(r["c"])(e.form).then(function(t){e.$notify({title:"修改成功",type:"success",duration:2500}),e.$parent.crud.toQuery(),e.loading=!1,e.dialog=!1}).catch(function(t){e.loading=!1,console.log(t.response.data.message)})})}}},n=o,s=a("0c7c"),c=Object(s["a"])(n,l,i,!1,null,"87f0ae40",null);t["default"]=c.exports},"5cdf":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticStyle:{"padding-left":"8px"},on:{"tab-click":e.tabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"本地存储",name:"first"}},[a("local",{ref:"local"})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"七牛云存储",name:"second"}},[a("qiniu",{ref:"qiniu"})],1)],1)},i=[],r=a("da2e"),o=a("d447"),n={name:"Storage",components:{Local:r["default"],Qiniu:o["default"]},data:function(){return{activeName:"first"}},methods:{tabClick:function(e){"first"===this.activeName?this.$refs.local.crud.toQuery():this.$refs.qiniu.crud.toQuery()}}},s=n,c=a("0c7c"),u=Object(c["a"])(s,l,i,!1,null,null,null);t["default"]=u.exports},"832b":function(e,t,a){"use strict";var l=a("eb5a"),i=a.n(l);i.a},a4ba:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"c",function(){return s});var l=a("9bd2");function i(e){return l["a"].deleteData("support/file/qiniu/delete",e)}function r(e){return l["a"].get("support/file/qiniu/sync",e)}function o(e){return l["a"].get("support/file/qiniu/download/".concat(e))}function n(){return l["a"].get("support/file/qiniu/getConfig")}function s(e){return l["a"].putData("support/file/qiniu/updateConfig",e)}t["a"]={sync:r,del:i,download:o}},b99f:function(e,t,a){"use strict";var l,i,r=a("5c96"),o=a("64fb"),n={name:"DateRangePicker",mixins:[r["DatePicker"]],props:{type:{type:String,default:"daterange"},valueFormat:{type:String,default:"yyyy-MM-dd HH:mm:ss"},defaultTime:{type:Array,default:function(e){return["00:00:00","23:59:59"]}},pickerOptions:{type:r["DatePickerOptions"],default:function(e){return{shortcuts:o["a"]}}},size:{type:String,default:"small"},rangeSeparator:{type:String,default:":"},startPlaceholder:{type:String,default:"开始日期"},endPlaceholder:{type:String,default:"结束日期"}}},s=n,c=a("0c7c"),u=Object(c["a"])(s,l,i,!1,null,null,null);t["a"]=u.exports},d447:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",staticStyle:{padding:"8px"}},[a("eForm",{ref:"form"}),e._v(" "),a("div",{staticClass:"head-container"},[e.crud.props.searchToggle?a("div",[a("label",{staticClass:"el-form-item-label"},[e._v("文件名")]),e._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"输入文件名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.crud.toQuery(t)}},model:{value:e.crud.entity.name,callback:function(t){e.$set(e.crud.entity,"name",t)},expression:"crud.entity.name"}}),e._v(" "),a("label",{staticClass:"el-form-item-label"},[e._v("创建时间")]),e._v(" "),a("date-range-picker",{staticClass:"date-item",model:{value:e.crud.params.updateTimeArr,callback:function(t){e.$set(e.crud.params,"updateTimeArr",t)},expression:"crud.params.updateTimeArr"}}),e._v(" "),a("rrOperation")],1):e._e(),e._v(" "),a("crudOperation",{attrs:{permission:e.permission}},[a("template",{slot:"left"},[a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-upload"},on:{click:function(t){e.dialog=!0}}},[e._v("上传")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{icon:e.icon,size:"mini",type:"warning"},on:{click:e.synchronize}},[e._v("同步")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-s-tools"},on:{click:e.doConfig}},[e._v("配置\n                ")])],1)],2),e._v(" "),a("el-dialog",{attrs:{visible:e.dialog,"close-on-click-modal":!1,"append-to-body":"",width:"500px"},on:{"update:visible":function(t){e.dialog=t},close:e.doSubmit}},[a("el-upload",{staticClass:"upload-demo",attrs:{"before-remove":e.handleBeforeRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.fileList,headers:e.headers,action:e.qiNiuUploadApi,multiple:""}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{display:"block"},attrs:{slot:"tip"},slot:"tip"},[e._v("请勿上传违法文件，且文件不超过15M")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.doSubmit}},[e._v("确认")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.crud.loading,expression:"crud.loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.crud.data},on:{"selection-change":e.crud.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"el-link el-link--primary",attrs:{href:"JavaScript:",target:"_self",type:"primary"},on:{click:function(a){return e.download(t.row.contentId)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"suffix",label:"文件类型"},on:{"selection-change":e.crud.selectionChangeHandler}}),e._v(" "),a("el-table-column",{attrs:{prop:"bucket",label:"空间名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"size",label:"文件大小"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"空间类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"创建日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.updateTime)))])]}}])})],1),e._v(" "),a("pagination")],1)],1)},i=[],r=a("cebc"),o=a("a4ba"),n=a("2f62"),s=a("ed08"),c=a("5024"),u=a("c6db"),d=a("4f59"),p=a("ab00"),f=a("55b8"),m=a("b99f"),b={components:{eForm:c["default"],pagination:f["a"],crudOperation:p["a"],rrOperation:d["a"],DateRangePicker:m["a"]},cruds:function(){return Object(u["b"])({title:"七牛云文件",url:"support/file/qiniu/page",crudMethod:Object(r["a"])({},o["a"])})},mixins:[Object(u["f"])(),Object(u["d"])(),Object(u["a"])()],data:function(){return{permission:{del:["storage:del"]},title:"文件",dialog:!1,icon:"el-icon-refresh",url:"",headers:{Authorization:"bearer "+s["b"].auth.getToken()},dialogImageUrl:"",dialogVisible:!1,fileList:[],files:[],newWin:null}},computed:Object(r["a"])({},Object(n["b"])(["qiNiuUploadApi"])),watch:{url:function(e,t){e&&this.newWin&&(this.newWin.sessionStorage.clear(),this.newWin.location.href=e,this.url="",this.newWin=null)}},created:function(){this.crud.optShow.add=!1,this.crud.optShow.edit=!1,this.crud.optShow.download=!1},methods:{doConfig:function(){var e=this.$refs.form;e.init(),e.dialog=!0},handleSuccess:function(e,t,a){var l=t.uid,i=e.id;this.files.push({uid:l,id:i})},handleBeforeRemove:function(e,t){for(var a=0;a<this.files.length;a++)if(this.files[a].uid===e.uid)return o["a"].del([this.files[a].id]).then(function(e){}),!0},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},doSubmit:function(){this.fileList=[],this.dialogVisible=!1,this.dialogImageUrl="",this.dialog=!1,this.crud.toQuery()},handleError:function(e,t,a){var l=JSON.parse(e.message);this.crud.notify(l.message,u["b"].NOTIFICATION_TYPE.ERROR)},download:function(e){var t=this;this.downloadLoading=!0,this.newWin=window.open(),o["a"].download(e).then(function(e){t.downloadLoading=!1,t.url=e.data.url}).catch(function(e){t.downloadLoading=!1,console.log(e.response.data.message)})},synchronize:function(){var e=this;this.icon="el-icon-loading",o["a"].sync().then(function(t){e.icon="el-icon-refresh",e.$message({showClose:!0,message:"数据同步成功",type:"success",duration:1500}),e.crud.toQuery()}).catch(function(t){e.icon="el-icon-refresh",console.log(t.response.data.message)})}}},v=b,h=a("0c7c"),g=Object(h["a"])(v,l,i,!1,null,"f2a39010",null);t["default"]=g.exports},da2e:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",staticStyle:{padding:"8px"}},[a("div",{staticClass:"head-container"},[e.crud.props.searchToggle?a("div",[a("label",{staticClass:"el-form-item-label"},[e._v("文件名")]),e._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"输入文件名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.crud.toQuery(t)}},model:{value:e.crud.entity.name,callback:function(t){e.$set(e.crud.entity,"name",t)},expression:"crud.entity.name"}}),e._v(" "),a("label",{staticClass:"el-form-item-label"},[e._v("分类")]),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small"},model:{value:e.crud.entity.type,callback:function(t){e.$set(e.crud.entity,"type",t)},expression:"crud.entity.type"}},[a("el-option",{key:"图片",attrs:{label:"图片",value:"图片"}}),e._v(" "),a("el-option",{key:"文档",attrs:{label:"文档",value:"文档"}}),e._v(" "),a("el-option",{key:"音乐",attrs:{label:"音乐",value:"音乐"}}),e._v(" "),a("el-option",{key:"视频",attrs:{label:"视频",value:"视频"}}),e._v(" "),a("el-option",{key:"其他",attrs:{label:"其他",value:"其他"}})],1),e._v(" "),a("label",{staticClass:"el-form-item-label"},[e._v("创建时间")]),e._v(" "),a("date-range-picker",{staticClass:"date-item",model:{value:e.crud.params.createTimeArr,callback:function(t){e.$set(e.crud.params,"createTimeArr",t)},expression:"crud.params.createTimeArr"}}),e._v(" "),a("rrOperation")],1):e._e(),e._v(" "),a("crudOperation",{attrs:{permission:e.permission}},[a("el-button",{directives:[{name:"has-permission",rawName:"v-has-permission",value:["storage:upload"],expression:"['storage:upload']"}],staticClass:"filter-item",attrs:{slot:"left",size:"mini",type:"primary",icon:"el-icon-upload"},on:{click:e.crud.toAdd},slot:"left"},[e._v("上传\n            ")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{slot:"right",size:"mini",type:"primary",icon:"el-icon-download"},on:{click:e.downloadBatch},slot:"right"},[e._v("下载\n            ")])],1)],1),e._v(" "),a("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,"before-close":e.crud.cancelCU,visible:e.crud.status.cu>0,title:e.crud.status.add?"文件上传":"编辑文件",width:"500px"},on:{"update:visible":function(t){return e.$set(e.crud.status,"cu > 0",t)}}},[a("el-form",{ref:"form",attrs:{model:e.form,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{label:"文件名"}},[a("el-input",{staticStyle:{width:"370px"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),e.crud.status.add?a("el-form-item",{attrs:{label:"上传"}},[a("el-upload",{ref:"upload",attrs:{limit:1,"before-upload":e.beforeUpload,"auto-upload":!1,headers:e.headers,"on-success":e.handleSuccess,"on-error":e.handleError,action:e.fileUploadApi+"?name="+e.form.name}},[a("div",{staticClass:"my-upload"},[a("i",{staticClass:"el-icon-upload"}),e._v(" 添加文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("可上传任意格式文件，且不超过100M")])])],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:e.crud.cancelCU}},[e._v("取消")]),e._v(" "),e.crud.status.add?a("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.upload}},[e._v("确认")]):a("el-button",{attrs:{loading:2===e.crud.status.cu,type:"primary"},on:{click:e.crud.submitCU}},[e._v("确认")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.crud.loading,expression:"crud.loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{size:"mini",data:e.crud.data},on:{"selection-change":e.crud.selectionChangeHandler}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{content:"/support/file/localStorage/file/"+t.row.realName,placement:"top-start",title:"路径",width:"200",trigger:"hover"}},[a("a",{staticClass:"el-link--primary",staticStyle:{"word-break":"keep-all","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",color:"#1890ff","font-size":"13px"},attrs:{slot:"reference",href:"javascript:;",target:"_blank"},on:{click:function(a){return e.download(t.row)}},slot:"reference"},[e._v("\n                        "+e._s(t.row.name)+"\n                    ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"suffix",label:"文件类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类别"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fileSize",label:"大小"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operate",label:"操作人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])})],1),e._v(" "),a("pagination")],1)},i=[],r=(a("ac6a"),a("f3e2"),a("7f7f"),a("cebc")),o=a("2f62"),n=a("ed08"),s=a("9bd2");function c(e){return s["a"].deleteData("support/file/localStorage/delete",e)}function u(e){return s["a"].putData("support/file/localStorage/update",e)}function d(e,t){return s["a"].downloadGet("support/file/localStorage/file/".concat(e),t)}function p(e,t){return s["a"].download("support/file/localStorage/fileBatch",e,t)}var f={edit:u,del:c},m=a("c6db"),b=a("4f59"),v=a("ab00"),h=a("55b8"),g=a("b99f"),y={id:null,name:""},_={components:{pagination:h["a"],crudOperation:v["a"],rrOperation:b["a"],DateRangePicker:g["a"]},cruds:function(){return Object(m["b"])({title:"文件",url:"support/file/localStorage/page",idField:"storageId",crudMethod:Object(r["a"])({},f)})},mixins:[Object(m["f"])(),Object(m["d"])(),Object(m["c"])(y),Object(m["a"])()],data:function(){return{delAllLoading:!1,loading:!1,headers:{Authorization:"bearer "+n["b"].auth.getToken()},permission:{edit:["storage:update"],del:["storage:delete"]}}},computed:Object(r["a"])({},Object(o["b"])(["baseApi","fileUploadApi"])),created:function(){this.crud.optShow.add=!1,this.crud.optShow.download=!1},methods:{upload:function(){this.$refs.upload.submit()},beforeUpload:function(e){var t=!0;return t=e.size/1024/1024<100,t||(this.loading=!1,this.$message.error("上传文件大小不能超过 100MB!")),this.form.name=e.name,t},handleSuccess:function(e,t,a){this.crud.notify("上传成功",m["b"].NOTIFICATION_TYPE.SUCCESS),this.$refs.upload.clearFiles(),this.crud.status.add=m["b"].STATUS.NORMAL,this.crud.resetForm(),this.crud.toQuery()},handleError:function(e,t,a){var l=JSON.parse(e.message);this.$notify({title:l.message,type:"error",duration:2500}),this.loading=!1},download:function(e){d(e.storageId,e.realName)},downloadBatch:function(){var e=this.crud.selections;if(e.length>0){var t=new Array;e.forEach(function(e){t.push(e.storageId)}),p(t,"批量下载.zip")}else this.$notify({title:"请勾选需要下载的文件",type:"warning",duration:2500})}}},k=_,w=(a("832b"),a("0c7c")),S=Object(w["a"])(k,l,i,!1,null,"6335f519",null);t["default"]=S.exports},eb5a:function(e,t,a){}}]);